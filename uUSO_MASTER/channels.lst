C51 COMPILER V9.00   CHANNELS                                                              05/22/2015 09:23:34 PAGE 1   


C51 COMPILER V9.00, COMPILATION OF MODULE CHANNELS
OBJECT MODULE PLACED IN channels.obj
COMPILER INVOKED BY: C:\Program Files\Keil\C51\BIN\C51.EXE proto_uso\channels.c LARGE OPTIMIZE(6,SPEED) BROWSE ORDER NOA
                    -REGS DEBUG OBJECTEXTEND CODE SYMBOLS PRINT(.\channels.lst) OBJECT(channels.obj)

line level    source

   1          #include "channels.h"
   2          #include "crc_table.h"
   3          
   4          //-----------------------------------
   5          volatile struct Channel xdata channels[CHANNEL_NUMBER] /*_at_ 0x20*/;
   6          extern unsigned char code Crc8Table[];
   7          
   8          unsigned char channel_number=CHANNEL_NUMBER;//количество каналов
   9          //-----------------------------------
  10          void ChannelsInit(void) //инициализация структуры каналов
  11          {       
  12   1              unsigned char i=0;
  13   1      
  14   1              Restore_Channels_Data();
  15   1      
  16   1              for(i=0;i<CHANNEL_NUMBER;i++)
  17   1              {
  18   2                      channels[i].channel_data=0;
  19   2              }
  20   1      
  21   1      //      channels[CHNL_DOL_ENC_0].settings.set.state_byte_1=0x40;
  22   1      //      channels[CHNL_DOL_ENC_0].settings.set.state_byte_2=0x0A;
  23   1      //      channels[CHNL_DOL_ENC_0].channel_data=0x80008000;
  24   1              return;
  25   1      }
  26          //-----------------------------------
  27          void Store_Channels_Data(void) //using 0//Сохраним данные каналов в ППЗУ
  28          {
  29   1              unsigned char i=0;
  30   1              unsigned long crc=0;
  31   1              for(i=0;i<CHANNEL_NUMBER;i++)
  32   1              {
  33   2                      EEPROM_Write(&channels[i].settings.serialize,1,ADC_SETTINGS_ADDR+i);
  34   2              }       
  35   1              crc=(unsigned long)Channels_Get_Settings_CRC();
  36   1              EEPROM_Write(&crc,1,SETTINGS_DEVICE_CRC_ADDR);//запомним CRC настроек
  37   1              return;
  38   1      }
  39          //-----------------------------------
  40          void Restore_Channels_Data(void) //using 0//Восстановим данные каналов из ППЗУ
  41          {
  42   1              unsigned char i=0;
  43   1              unsigned long crc=0, crc_true=0;
  44   1              for(i=0;i<CHANNEL_NUMBER;i++)
  45   1              {
  46   2                      EEPROM_Read(&channels[i].settings.serialize,1,ADC_SETTINGS_ADDR+i);
  47   2              }
  48   1              crc_true=(unsigned long)Channels_Get_Settings_CRC();
  49   1              EEPROM_Read(&crc,1,SETTINGS_DEVICE_CRC_ADDR);//считаем CRC настроек
  50   1      
  51   1              if(crc_true!=crc)//сбой eeprom, обнулим настройки
  52   1              {
  53   2                      Channels_Set_Default();
  54   2              }
C51 COMPILER V9.00   CHANNELS                                                              05/22/2015 09:23:34 PAGE 2   

  55   1      
  56   1              return;
  57   1      }
  58          //----------------------------------
  59          void Channels_Set_Default(void)//сбросить значения каналов по умолчанию
  60          {       
  61   1      
  62   1                      channels[CHNL_ADC_0].number=CHNL_ADC_0;          
  63   1                      channels[CHNL_ADC_0].settings.set.type=CHNL_ADC;
  64   1                      channels[CHNL_ADC_0].settings.set.modific=CHNL_ADC_FIX_24;
  65   1                      channels[CHNL_ADC_0].settings.set.state_byte_1=0x40;
  66   1                      channels[CHNL_ADC_0].settings.set.state_byte_2=0x06;
  67   1                      channels[CHNL_ADC_0].channel_data=0;
  68   1                      channels[CHNL_ADC_0].channel_data_calibrate=0;
  69   1                      // КАНАЛ 2 - фиксированый АЦП
  70   1                      channels[CHNL_ADC_1].number=CHNL_ADC_1;
  71   1                      channels[CHNL_ADC_1].settings.set.type=CHNL_ADC;
  72   1                      channels[CHNL_ADC_1].settings.set.modific=CHNL_ADC_FIX_24;
  73   1                      channels[CHNL_ADC_1].settings.set.state_byte_1=0x40;
  74   1                      channels[CHNL_ADC_1].settings.set.state_byte_2=0x06;
  75   1                      channels[CHNL_ADC_1].channel_data=0;
  76   1                      channels[CHNL_ADC_1].channel_data_calibrate=0;
  77   1                      // КАНАЛ 3 - фиксированый АЦП
  78   1                      channels[CHNL_ADC_2].number=CHNL_ADC_2;          
  79   1                      channels[CHNL_ADC_2].settings.set.type=CHNL_ADC;
  80   1                      channels[CHNL_ADC_2].settings.set.modific=CHNL_ADC_FIX_24;
  81   1                      channels[CHNL_ADC_2].settings.set.state_byte_1=0x40;
  82   1                      channels[CHNL_ADC_2].settings.set.state_byte_2=0x06;
  83   1                      channels[CHNL_ADC_2].channel_data=0;
  84   1                      channels[CHNL_ADC_2].channel_data_calibrate=0;
  85   1                      // КАНАЛ 4 - фиксированый АЦП
  86   1                      channels[CHNL_ADC_3].number=CHNL_ADC_3;          
  87   1                      channels[CHNL_ADC_3].settings.set.type=CHNL_ADC;
  88   1                      channels[CHNL_ADC_3].settings.set.modific=CHNL_ADC_FIX_24;
  89   1                      channels[CHNL_ADC_3].settings.set.state_byte_1=0x40;
  90   1                      channels[CHNL_ADC_3].settings.set.state_byte_2=0x06;
  91   1                      channels[CHNL_ADC_3].channel_data=0;
  92   1                      channels[CHNL_ADC_3].channel_data_calibrate=0;
  93   1      //              // КАНАЛ 5 - фиксированый АЦП
  94   1      //              channels[CHNL_ADC_4].number=CHNL_ADC_4;          
  95   1      //              channels[CHNL_ADC_4].settings.set.type=CHNL_ADC;
  96   1      //              channels[CHNL_ADC_4].settings.set.modific=CHNL_ADC_FIX_24;
  97   1      //              channels[CHNL_ADC_4].settings.set.state_byte_1=0x40;
  98   1      //              channels[CHNL_ADC_4].settings.set.state_byte_2=0x06;
  99   1      //              channels[CHNL_ADC_4].channel_data=0;
 100   1      //              channels[CHNL_ADC_4].channel_data_calibrate=0;
 101   1      //              // КАНАЛ 6 - фиксированый АЦП
 102   1      //              channels[CHNL_ADC_5].number=CHNL_ADC_5;          
 103   1      //              channels[CHNL_ADC_5].settings.set.type=CHNL_ADC;
 104   1      //              channels[CHNL_ADC_5].settings.set.modific=CHNL_ADC_FIX_24;
 105   1      //              channels[CHNL_ADC_5].settings.set.state_byte_1=0x40;
 106   1      //              channels[CHNL_ADC_5].settings.set.state_byte_2=0x06;
 107   1      //              channels[CHNL_ADC_5].channel_data=0;
 108   1      //              channels[CHNL_ADC_5].channel_data_calibrate=0;
 109   1      //              // КАНАЛ 7 - фиксированый АЦП
 110   1      //              channels[CHNL_ADC_6].number=CHNL_ADC_6;          
 111   1      //              channels[CHNL_ADC_6].settings.set.type=CHNL_ADC;
 112   1      //              channels[CHNL_ADC_6].settings.set.modific=CHNL_ADC_FIX_24;
 113   1      //              channels[CHNL_ADC_6].settings.set.state_byte_1=0x40;
 114   1      //              channels[CHNL_ADC_6].settings.set.state_byte_2=0x06;
 115   1      //              channels[CHNL_ADC_6].channel_data=0;
 116   1      //              channels[CHNL_ADC_6].channel_data_calibrate=0;
C51 COMPILER V9.00   CHANNELS                                                              05/22/2015 09:23:34 PAGE 3   

 117   1      //              // КАНАЛ 8 - фиксированый АЦП
 118   1      //              channels[CHNL_ADC_7].number=CHNL_ADC_7;          
 119   1      //              channels[CHNL_ADC_7].settings.set.type=CHNL_ADC;
 120   1      //              channels[CHNL_ADC_7].settings.set.modific=CHNL_ADC_FIX_24;
 121   1      //              channels[CHNL_ADC_7].settings.set.state_byte_1=0x40;
 122   1      //              channels[CHNL_ADC_7].settings.set.state_byte_2=0x06;
 123   1      //              channels[CHNL_ADC_7].channel_data=0;
 124   1      //              channels[CHNL_ADC_7].channel_data_calibrate=0;
 125   1      //              // КАНАЛ 9 - Частотомер 0-256 Гц
 126   1      //              channels[CHNL_FREQ_256_0].number=CHNL_FREQ_256_0;                
 127   1      //              channels[CHNL_FREQ_256_0].settings.set.type=CHNL_FREQ;
 128   1      //              channels[CHNL_FREQ_256_0].settings.set.modific=CHNL_FREQ_256;
 129   1      //              channels[CHNL_FREQ_256_0].settings.set.state_byte_1=0x40;
 130   1      //              channels[CHNL_FREQ_256_0].settings.set.state_byte_2=0x0A;
 131   1      //              channels[CHNL_FREQ_256_0].channel_data=0x0;
 132   1      //              // КАНАЛ 10 - Частотомер 0-256 Гц
 133   1      //              channels[CHNL_FREQ_256_1].number=CHNL_FREQ_256_1;                
 134   1      //              channels[CHNL_FREQ_256_1].settings.set.type=CHNL_FREQ;
 135   1      //              channels[CHNL_FREQ_256_1].settings.set.modific=CHNL_FREQ_256;
 136   1      //              channels[CHNL_FREQ_256_1].settings.set.state_byte_1=0x40;
 137   1      //              channels[CHNL_FREQ_256_1].settings.set.state_byte_2=0x0A;
 138   1      //              channels[CHNL_FREQ_256_1].channel_data=0x0;
 139   1      //              // КАНАЛ 11 - Частотомер 0-256 Гц
 140   1      //              channels[CHNL_FREQ_256_2].number=CHNL_FREQ_256_2;                
 141   1      //              channels[CHNL_FREQ_256_2].settings.set.type=CHNL_FREQ;
 142   1      //              channels[CHNL_FREQ_256_2].settings.set.modific=CHNL_FREQ_256;
 143   1      //              channels[CHNL_FREQ_256_2].settings.set.state_byte_1=0x40;
 144   1      //              channels[CHNL_FREQ_256_2].settings.set.state_byte_2=0x0A;
 145   1      //              channels[CHNL_FREQ_256_2].channel_data=0x1;
 146   1      //              // КАНАЛ 12 - ДОЛ I2C
 147   1      //              channels[CHNL_DOL_ENC_0].number=CHNL_DOL_ENC_0;          
 148   1      //              channels[CHNL_DOL_ENC_0].settings.set.type=CHNL_DOL;
 149   1      //              channels[CHNL_DOL_ENC_0].settings.set.modific=CHNL_DOL_ENC;
 150   1      //              channels[CHNL_DOL_ENC_0].settings.set.state_byte_1=0x40;
 151   1      //              channels[CHNL_DOL_ENC_0].settings.set.state_byte_2=0x0A;
 152   1      //              channels[CHNL_DOL_ENC_0].channel_data=0x80008000;
 153   1                                      // КАНАЛ 13 частота
 154   1                      channels[CHNL_FREQ_COUNT_T_0].number=CHNL_FREQ_COUNT_T_0;                
 155   1                      channels[CHNL_FREQ_COUNT_T_0].settings.set.type=CHNL_FREQ;
 156   1                      channels[CHNL_FREQ_COUNT_T_0].settings.set.modific=CHNL_FREQ_COUNT_T;
 157   1                      channels[CHNL_FREQ_COUNT_T_0].settings.set.state_byte_1=0x40;
 158   1                      channels[CHNL_FREQ_COUNT_T_0].settings.set.state_byte_2=0x0A;
 159   1                      channels[CHNL_FREQ_COUNT_T_0].channel_data=0x0;
 160   1                                      // КАНАЛ 14 частота средняя
 161   1                      channels[CHNL_FREQ_COUNT_T_1].number=CHNL_FREQ_COUNT_T_1;                
 162   1                      channels[CHNL_FREQ_COUNT_T_1].settings.set.type=CHNL_FREQ;
 163   1                      channels[CHNL_FREQ_COUNT_T_1].settings.set.modific=CHNL_FREQ_COUNT_T;
 164   1                      channels[CHNL_FREQ_COUNT_T_1].settings.set.state_byte_1=0x40;
 165   1                      channels[CHNL_FREQ_COUNT_T_1].settings.set.state_byte_2=0x0A;
 166   1                      channels[CHNL_FREQ_COUNT_T_1].channel_data=0x0; 
 167   1      
 168   1                      Store_Channels_Data();
 169   1      
 170   1      }
 171          //-------------------------------
 172          unsigned char Channels_Get_Settings_CRC(void)//расчет crc настроек в eerprom
 173          {
 174   1               unsigned char crc = 0x0;
 175   1               unsigned char i=0,j=0;
 176   1      
 177   1           for(i=0;i<CHANNEL_NUMBER;i++)
 178   1               {
C51 COMPILER V9.00   CHANNELS                                                              05/22/2015 09:23:34 PAGE 4   

 179   2              for(j=0;j<4;j++)
 180   2                      {
 181   3                              crc = Crc8Table[crc ^ (((unsigned char *)(&channels[i].settings.serialize))[j])];
 182   3                      }
 183   2               }
 184   1      
 185   1           return crc;
 186   1      }
C51 COMPILER V9.00   CHANNELS                                                              05/22/2015 09:23:34 PAGE 5   

ASSEMBLY LISTING OF GENERATED OBJECT CODE


             ; FUNCTION ChannelsInit (BEGIN)
                                           ; SOURCE LINE # 10
                                           ; SOURCE LINE # 11
                                           ; SOURCE LINE # 12
0000 E4                CLR     A
0001 900000      R     MOV     DPTR,#i
0004 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 14
0005 120000      R     LCALL   Restore_Channels_Data
                                           ; SOURCE LINE # 16
0008 E4                CLR     A
0009 900000      R     MOV     DPTR,#i
000C F0                MOVX    @DPTR,A
000D         ?C0001:
000D 900000      R     MOV     DPTR,#i
0010 E0                MOVX    A,@DPTR
0011 FF                MOV     R7,A
0012 C3                CLR     C
0013 9406              SUBB    A,#06H
0015 501D              JNC     ?C0004
                                           ; SOURCE LINE # 17
                                           ; SOURCE LINE # 18
0017 EF                MOV     A,R7
0018 75F019            MOV     B,#019H
001B A4                MUL     AB
001C 2400        R     ADD     A,#LOW channels+05H
001E F582              MOV     DPL,A
0020 E4                CLR     A
0021 3400        R     ADDC    A,#HIGH channels+05H
0023 F583              MOV     DPH,A
0025 120000      E     LCALL   ?C?LSTKXDATA
0028 00                DB      00H
0029 00                DB      00H
002A 00                DB      00H
002B 00                DB      00H
                                           ; SOURCE LINE # 19
002C 900000      R     MOV     DPTR,#i
002F E0                MOVX    A,@DPTR
0030 04                INC     A
0031 F0                MOVX    @DPTR,A
0032 80D9              SJMP    ?C0001
                                           ; SOURCE LINE # 25
0034         ?C0004:
0034 22                RET     
             ; FUNCTION ChannelsInit (END)

             ; FUNCTION Store_Channels_Data (BEGIN)
                                           ; SOURCE LINE # 27
                                           ; SOURCE LINE # 28
                                           ; SOURCE LINE # 29
0000 E4                CLR     A
0001 900000      R     MOV     DPTR,#i
0004 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 30
0005 A3                INC     DPTR
0006 120000      E     LCALL   ?C?LSTKXDATA
0009 00                DB      00H
000A 00                DB      00H
000B 00                DB      00H
C51 COMPILER V9.00   CHANNELS                                                              05/22/2015 09:23:34 PAGE 6   

000C 00                DB      00H
                                           ; SOURCE LINE # 31
000D E4                CLR     A
000E 900000      R     MOV     DPTR,#i
0011 F0                MOVX    @DPTR,A
0012         ?C0005:
0012 900000      R     MOV     DPTR,#i
0015 E0                MOVX    A,@DPTR
0016 FF                MOV     R7,A
0017 C3                CLR     C
0018 9406              SUBB    A,#06H
001A 502B              JNC     ?C0006
                                           ; SOURCE LINE # 32
                                           ; SOURCE LINE # 33
001C EF                MOV     A,R7
001D 75F019            MOV     B,#019H
0020 A4                MUL     AB
0021 2400        R     ADD     A,#LOW channels+01H
0023 F9                MOV     R1,A
0024 7400        R     MOV     A,#HIGH channels+01H
0026 35F0              ADDC    A,B
0028 FA                MOV     R2,A
0029 7B01              MOV     R3,#01H
002B E0                MOVX    A,@DPTR
002C 2410              ADD     A,#010H
002E FE                MOV     R6,A
002F E4                CLR     A
0030 33                RLC     A
0031 900000      E     MOV     DPTR,#?_EEPROM_Write?BYTE+05H
0034 F0                MOVX    @DPTR,A
0035 A3                INC     DPTR
0036 CE                XCH     A,R6
0037 F0                MOVX    @DPTR,A
0038 7D01              MOV     R5,#01H
003A 7C00              MOV     R4,#00H
003C 120000      E     LCALL   _EEPROM_Write
                                           ; SOURCE LINE # 34
003F 900000      R     MOV     DPTR,#i
0042 E0                MOVX    A,@DPTR
0043 04                INC     A
0044 F0                MOVX    @DPTR,A
0045 80CB              SJMP    ?C0005
0047         ?C0006:
                                           ; SOURCE LINE # 35
0047 120000      R     LCALL   Channels_Get_Settings_CRC
004A E4                CLR     A
004B FC                MOV     R4,A
004C FD                MOV     R5,A
004D FE                MOV     R6,A
004E 900000      R     MOV     DPTR,#crc
0051 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 36
0054 7B01              MOV     R3,#01H
0056 7A00        R     MOV     R2,#HIGH crc
0058 7900        R     MOV     R1,#LOW crc
005A 900000      E     MOV     DPTR,#?_EEPROM_Write?BYTE+05H
005D E4                CLR     A
005E F0                MOVX    @DPTR,A
005F A3                INC     DPTR
0060 74A0              MOV     A,#0A0H
0062 F0                MOVX    @DPTR,A
0063 7D01              MOV     R5,#01H
C51 COMPILER V9.00   CHANNELS                                                              05/22/2015 09:23:34 PAGE 7   

0065 7C00              MOV     R4,#00H
0067 120000      E     LCALL   _EEPROM_Write
                                           ; SOURCE LINE # 38
006A         ?C0008:
006A 22                RET     
             ; FUNCTION Store_Channels_Data (END)

             ; FUNCTION Restore_Channels_Data (BEGIN)
                                           ; SOURCE LINE # 40
                                           ; SOURCE LINE # 41
                                           ; SOURCE LINE # 42
0000 E4                CLR     A
0001 900000      R     MOV     DPTR,#i
0004 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 43
0005 A3                INC     DPTR
0006 120000      E     LCALL   ?C?LSTKXDATA
0009 00                DB      00H
000A 00                DB      00H
000B 00                DB      00H
000C 00                DB      00H
000D 900000      R     MOV     DPTR,#crc_true
0010 120000      E     LCALL   ?C?LSTKXDATA
0013 00                DB      00H
0014 00                DB      00H
0015 00                DB      00H
0016 00                DB      00H
                                           ; SOURCE LINE # 44
0017 E4                CLR     A
0018 900000      R     MOV     DPTR,#i
001B F0                MOVX    @DPTR,A
001C         ?C0009:
001C 900000      R     MOV     DPTR,#i
001F E0                MOVX    A,@DPTR
0020 FF                MOV     R7,A
0021 C3                CLR     C
0022 9406              SUBB    A,#06H
0024 502B              JNC     ?C0010
                                           ; SOURCE LINE # 45
                                           ; SOURCE LINE # 46
0026 EF                MOV     A,R7
0027 75F019            MOV     B,#019H
002A A4                MUL     AB
002B 2400        R     ADD     A,#LOW channels+01H
002D F9                MOV     R1,A
002E 7400        R     MOV     A,#HIGH channels+01H
0030 35F0              ADDC    A,B
0032 FA                MOV     R2,A
0033 7B01              MOV     R3,#01H
0035 E0                MOVX    A,@DPTR
0036 2410              ADD     A,#010H
0038 FE                MOV     R6,A
0039 E4                CLR     A
003A 33                RLC     A
003B 900000      E     MOV     DPTR,#?_EEPROM_Read?BYTE+05H
003E F0                MOVX    @DPTR,A
003F A3                INC     DPTR
0040 CE                XCH     A,R6
0041 F0                MOVX    @DPTR,A
0042 7D01              MOV     R5,#01H
0044 7C00              MOV     R4,#00H
0046 120000      E     LCALL   _EEPROM_Read
C51 COMPILER V9.00   CHANNELS                                                              05/22/2015 09:23:34 PAGE 8   

                                           ; SOURCE LINE # 47
0049 900000      R     MOV     DPTR,#i
004C E0                MOVX    A,@DPTR
004D 04                INC     A
004E F0                MOVX    @DPTR,A
004F 80CB              SJMP    ?C0009
0051         ?C0010:
                                           ; SOURCE LINE # 48
0051 120000      R     LCALL   Channels_Get_Settings_CRC
0054 E4                CLR     A
0055 FC                MOV     R4,A
0056 FD                MOV     R5,A
0057 FE                MOV     R6,A
0058 900000      R     MOV     DPTR,#crc_true
005B 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 49
005E 7B01              MOV     R3,#01H
0060 7A00        R     MOV     R2,#HIGH crc
0062 7900        R     MOV     R1,#LOW crc
0064 900000      E     MOV     DPTR,#?_EEPROM_Read?BYTE+05H
0067 E4                CLR     A
0068 F0                MOVX    @DPTR,A
0069 A3                INC     DPTR
006A 74A0              MOV     A,#0A0H
006C F0                MOVX    @DPTR,A
006D 7D01              MOV     R5,#01H
006F 7C00              MOV     R4,#00H
0071 120000      E     LCALL   _EEPROM_Read
                                           ; SOURCE LINE # 51
0074 900000      R     MOV     DPTR,#crc
0077 E0                MOVX    A,@DPTR
0078 FC                MOV     R4,A
0079 A3                INC     DPTR
007A E0                MOVX    A,@DPTR
007B FD                MOV     R5,A
007C A3                INC     DPTR
007D E0                MOVX    A,@DPTR
007E FE                MOV     R6,A
007F A3                INC     DPTR
0080 E0                MOVX    A,@DPTR
0081 FF                MOV     R7,A
0082 A3                INC     DPTR
0083 E0                MOVX    A,@DPTR
0084 F8                MOV     R0,A
0085 A3                INC     DPTR
0086 E0                MOVX    A,@DPTR
0087 F9                MOV     R1,A
0088 A3                INC     DPTR
0089 E0                MOVX    A,@DPTR
008A FA                MOV     R2,A
008B A3                INC     DPTR
008C E0                MOVX    A,@DPTR
008D FB                MOV     R3,A
008E C3                CLR     C
008F 120000      E     LCALL   ?C?ULCMP
0092 6003              JZ      ?C0013
                                           ; SOURCE LINE # 52
                                           ; SOURCE LINE # 53
0094 120000      R     LCALL   Channels_Set_Default
                                           ; SOURCE LINE # 54
                                           ; SOURCE LINE # 57
0097         ?C0013:
C51 COMPILER V9.00   CHANNELS                                                              05/22/2015 09:23:34 PAGE 9   

0097 22                RET     
             ; FUNCTION Restore_Channels_Data (END)

             ; FUNCTION Channels_Set_Default (BEGIN)
                                           ; SOURCE LINE # 59
                                           ; SOURCE LINE # 60
                                           ; SOURCE LINE # 62
0000 E4                CLR     A
0001 900000      R     MOV     DPTR,#channels
0004 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 63
0005 A3                INC     DPTR
0006 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 64
0007 A3                INC     DPTR
0008 7403              MOV     A,#03H
000A F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 65
000B A3                INC     DPTR
000C 7440              MOV     A,#040H
000E F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 66
000F A3                INC     DPTR
0010 7406              MOV     A,#06H
0012 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 67
0013 A3                INC     DPTR
0014 120000      E     LCALL   ?C?LSTKXDATA
0017 00                DB      00H
0018 00                DB      00H
0019 00                DB      00H
001A 00                DB      00H
                                           ; SOURCE LINE # 68
001B 900000      R     MOV     DPTR,#channels+09H
001E 120000      E     LCALL   ?C?LSTKXDATA
0021 00                DB      00H
0022 00                DB      00H
0023 00                DB      00H
0024 00                DB      00H
                                           ; SOURCE LINE # 70
0025 900000      R     MOV     DPTR,#channels+019H
0028 7401              MOV     A,#01H
002A F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 71
002B E4                CLR     A
002C A3                INC     DPTR
002D F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 72
002E A3                INC     DPTR
002F 7403              MOV     A,#03H
0031 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 73
0032 A3                INC     DPTR
0033 7440              MOV     A,#040H
0035 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 74
0036 A3                INC     DPTR
0037 7406              MOV     A,#06H
0039 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 75
003A A3                INC     DPTR
003B 120000      E     LCALL   ?C?LSTKXDATA
C51 COMPILER V9.00   CHANNELS                                                              05/22/2015 09:23:34 PAGE 10  

003E 00                DB      00H
003F 00                DB      00H
0040 00                DB      00H
0041 00                DB      00H
                                           ; SOURCE LINE # 76
0042 900000      R     MOV     DPTR,#channels+022H
0045 120000      E     LCALL   ?C?LSTKXDATA
0048 00                DB      00H
0049 00                DB      00H
004A 00                DB      00H
004B 00                DB      00H
                                           ; SOURCE LINE # 78
004C 900000      R     MOV     DPTR,#channels+032H
004F 7402              MOV     A,#02H
0051 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 79
0052 E4                CLR     A
0053 A3                INC     DPTR
0054 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 80
0055 A3                INC     DPTR
0056 7403              MOV     A,#03H
0058 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 81
0059 A3                INC     DPTR
005A 7440              MOV     A,#040H
005C F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 82
005D A3                INC     DPTR
005E 7406              MOV     A,#06H
0060 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 83
0061 A3                INC     DPTR
0062 120000      E     LCALL   ?C?LSTKXDATA
0065 00                DB      00H
0066 00                DB      00H
0067 00                DB      00H
0068 00                DB      00H
                                           ; SOURCE LINE # 84
0069 900000      R     MOV     DPTR,#channels+03BH
006C 120000      E     LCALL   ?C?LSTKXDATA
006F 00                DB      00H
0070 00                DB      00H
0071 00                DB      00H
0072 00                DB      00H
                                           ; SOURCE LINE # 86
0073 900000      R     MOV     DPTR,#channels+04BH
0076 7403              MOV     A,#03H
0078 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 87
0079 E4                CLR     A
007A A3                INC     DPTR
007B F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 88
007C A3                INC     DPTR
007D 7403              MOV     A,#03H
007F F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 89
0080 A3                INC     DPTR
0081 7440              MOV     A,#040H
0083 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 90
C51 COMPILER V9.00   CHANNELS                                                              05/22/2015 09:23:34 PAGE 11  

0084 A3                INC     DPTR
0085 7406              MOV     A,#06H
0087 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 91
0088 A3                INC     DPTR
0089 120000      E     LCALL   ?C?LSTKXDATA
008C 00                DB      00H
008D 00                DB      00H
008E 00                DB      00H
008F 00                DB      00H
                                           ; SOURCE LINE # 92
0090 900000      R     MOV     DPTR,#channels+054H
0093 120000      E     LCALL   ?C?LSTKXDATA
0096 00                DB      00H
0097 00                DB      00H
0098 00                DB      00H
0099 00                DB      00H
                                           ; SOURCE LINE # 154
009A 900000      R     MOV     DPTR,#channels+064H
009D 7404              MOV     A,#04H
009F F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 155
00A0 A3                INC     DPTR
00A1 7402              MOV     A,#02H
00A3 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 156
00A4 E4                CLR     A
00A5 A3                INC     DPTR
00A6 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 157
00A7 A3                INC     DPTR
00A8 7440              MOV     A,#040H
00AA F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 158
00AB A3                INC     DPTR
00AC 740A              MOV     A,#0AH
00AE F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 159
00AF A3                INC     DPTR
00B0 120000      E     LCALL   ?C?LSTKXDATA
00B3 00                DB      00H
00B4 00                DB      00H
00B5 00                DB      00H
00B6 00                DB      00H
                                           ; SOURCE LINE # 161
00B7 900000      R     MOV     DPTR,#channels+07DH
00BA 7405              MOV     A,#05H
00BC F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 162
00BD A3                INC     DPTR
00BE 7402              MOV     A,#02H
00C0 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 163
00C1 E4                CLR     A
00C2 A3                INC     DPTR
00C3 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 164
00C4 A3                INC     DPTR
00C5 7440              MOV     A,#040H
00C7 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 165
00C8 A3                INC     DPTR
C51 COMPILER V9.00   CHANNELS                                                              05/22/2015 09:23:34 PAGE 12  

00C9 740A              MOV     A,#0AH
00CB F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 166
00CC A3                INC     DPTR
00CD 120000      E     LCALL   ?C?LSTKXDATA
00D0 00                DB      00H
00D1 00                DB      00H
00D2 00                DB      00H
00D3 00                DB      00H
                                           ; SOURCE LINE # 168
00D4 120000      R     LCALL   Store_Channels_Data
                                           ; SOURCE LINE # 170
00D7 22                RET     
             ; FUNCTION Channels_Set_Default (END)

             ; FUNCTION Channels_Get_Settings_CRC (BEGIN)
                                           ; SOURCE LINE # 172
                                           ; SOURCE LINE # 173
                                           ; SOURCE LINE # 174
0000 E4                CLR     A
0001 900000      R     MOV     DPTR,#crc
0004 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 175
0005 A3                INC     DPTR
0006 F0                MOVX    @DPTR,A
0007 A3                INC     DPTR
0008 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 177
0009 900000      R     MOV     DPTR,#i
000C F0                MOVX    @DPTR,A
000D         ?C0015:
                                           ; SOURCE LINE # 178
                                           ; SOURCE LINE # 179
000D E4                CLR     A
000E 900000      R     MOV     DPTR,#j
0011 F0                MOVX    @DPTR,A
0012         ?C0018:
                                           ; SOURCE LINE # 180
                                           ; SOURCE LINE # 181
0012 900000      R     MOV     DPTR,#i
0015 E0                MOVX    A,@DPTR
0016 75F019            MOV     B,#019H
0019 A4                MUL     AB
001A 2400        R     ADD     A,#LOW channels+01H
001C F9                MOV     R1,A
001D 7400        R     MOV     A,#HIGH channels+01H
001F 35F0              ADDC    A,B
0021 FA                MOV     R2,A
0022 7B01              MOV     R3,#01H
0024 A3                INC     DPTR
0025 E0                MOVX    A,@DPTR
0026 7E00              MOV     R6,#00H
0028 29                ADD     A,R1
0029 F9                MOV     R1,A
002A EE                MOV     A,R6
002B 3A                ADDC    A,R2
002C FA                MOV     R2,A
002D 120000      E     LCALL   ?C?CLDPTR
0030 FF                MOV     R7,A
0031 900000      R     MOV     DPTR,#crc
0034 E0                MOVX    A,@DPTR
0035 6F                XRL     A,R7
C51 COMPILER V9.00   CHANNELS                                                              05/22/2015 09:23:34 PAGE 13  

0036 900000      E     MOV     DPTR,#Crc8Table
0039 93                MOVC    A,@A+DPTR
003A 900000      R     MOV     DPTR,#crc
003D F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 182
003E 900000      R     MOV     DPTR,#j
0041 E0                MOVX    A,@DPTR
0042 04                INC     A
0043 F0                MOVX    @DPTR,A
0044 E0                MOVX    A,@DPTR
0045 B404CA            CJNE    A,#04H,?C0018
                                           ; SOURCE LINE # 183
0048         ?C0017:
0048 900000      R     MOV     DPTR,#i
004B E0                MOVX    A,@DPTR
004C 04                INC     A
004D F0                MOVX    @DPTR,A
004E E0                MOVX    A,@DPTR
004F B406BB            CJNE    A,#06H,?C0015
0052         ?C0016:
                                           ; SOURCE LINE # 185
0052 900000      R     MOV     DPTR,#crc
0055 E0                MOVX    A,@DPTR
0056 FF                MOV     R7,A
                                           ; SOURCE LINE # 186
0057         ?C0021:
0057 22                RET     
             ; FUNCTION Channels_Get_Settings_CRC (END)

C51 COMPILER V9.00   CHANNELS                                                              05/22/2015 09:23:34 PAGE 14  

NAME                                    CLASS   MSPACE  TYPE    OFFSET  SIZE
====                                    =====   ======  ====    ======  ====


TCON . . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   0088H  1
SCON . . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   0098H  1
P2 . . . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00A0H  1
IE . . . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00A8H  1
P3 . . . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00B0H  1
IP . . . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00B8H  1
WDCON. . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00C0H  1
T2CON. . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00C8H  1
PSW. . . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00D0H  1
ADCSTAT. . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00D8H  1
I2CCON . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00E8H  1
DCON . . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00E8H  1
SPICON . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00F8H  1
_EEPROM_Read . . . . . . . . . . . . .  EXTERN   CODE   PROC     -----  -----
_EEPROM_Write. . . . . . . . . . . . .  EXTERN   CODE   PROC     -----  -----
CHNL_ADC_0 . . . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
CHNL_ADC_1 . . . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
CHNL_ADC_2 . . . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
CHNL_ADC_3 . . . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
CHNL_FREQ_COUNT_T_0. . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
CHNL_FREQ_COUNT_T_1. . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
Channel. . . . . . . . . . . . . . . .  * TAG *  -----  STRUCT   -----  25
  number . . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0000H  1
  settings . . . . . . . . . . . . . .  MEMBER   -----  UNION    0001H  4
  channel_data . . . . . . . . . . . .  MEMBER   -----  U_LONG   0005H  4
  channel_data_calibrate . . . . . . .  MEMBER   -----  U_LONG   0009H  4
  calibrate. . . . . . . . . . . . . .  MEMBER   -----  UNION    000DH  12
ChannelsInit . . . . . . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  i. . . . . . . . . . . . . . . . . .  AUTO     XDATA  U_CHAR   0000H  1
Store_Channels_Data. . . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  i. . . . . . . . . . . . . . . . . .  AUTO     XDATA  U_CHAR   0000H  1
  crc. . . . . . . . . . . . . . . . .  AUTO     XDATA  U_LONG   0001H  4
Restore_Channels_Data. . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  i. . . . . . . . . . . . . . . . . .  AUTO     XDATA  U_CHAR   0000H  1
  crc. . . . . . . . . . . . . . . . .  AUTO     XDATA  U_LONG   0001H  4
  crc_true . . . . . . . . . . . . . .  AUTO     XDATA  U_LONG   0005H  4
Channels_Set_Default . . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
Channels_Get_Settings_CRC. . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  crc. . . . . . . . . . . . . . . . .  AUTO     XDATA  U_CHAR   0000H  1
  i. . . . . . . . . . . . . . . . . .  AUTO     XDATA  U_CHAR   0001H  1
  j. . . . . . . . . . . . . . . . . .  AUTO     XDATA  U_CHAR   0002H  1
Crc8Table. . . . . . . . . . . . . . .  EXTERN   CODE   ARRAY    -----  -----
channels . . . . . . . . . . . . . . .  PUBLIC   XDATA  ARRAY    0000H  150
channel_number . . . . . . . . . . . .  PUBLIC   XDATA  U_CHAR   0096H  1


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    616    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =    151      18
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
