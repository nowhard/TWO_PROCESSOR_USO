C51 COMPILER V9.00   EEPROM                                                                04/24/2015 12:10:34 PAGE 1   


C51 COMPILER V9.00, COMPILATION OF MODULE EEPROM
OBJECT MODULE PLACED IN eeprom.obj
COMPILER INVOKED BY: C:\Program Files\Keil\C51\BIN\C51.EXE eeprom\eeprom.c LARGE OPTIMIZE(9,SPEED) BROWSE ORDER NOAREGS 
                    -MODAB2 DEBUG OBJECTEXTEND PRINT(.\eeprom.lst) OBJECT(eeprom.obj)

line level    source

   1          #include "eeprom.h"
   2          
   3           //----------------------------------------------------------------------------------
   4          unsigned int  EEPROM_Write(void *buffer,unsigned int len,unsigned int addr) //using 0//записать буфер по а
             -дресу
   5          {
   6   1      //небезопасная
   7   1        unsigned int i=0;
   8   1        unsigned char *buf;
   9   1                                                         
  10   1        if (addr+len>= EEMEM_SIZE) //если адрес выходит за границы
  11   1              return (0UL);
  12   1      
  13   1              buf=buffer;
  14   1      
  15   1         for(i=0;i<len;i++)
  16   1         {       
  17   2                 EDATA1=buf[i*4]; 
  18   2                 EDATA2=buf[i*4+1]; 
  19   2                 EDATA3=buf[i*4+2]; 
  20   2                 EDATA4=buf[i*4+3]; 
  21   2                
  22   2                 EADR=addr;
  23   2      
  24   2                 ECON=EE_ERASE_PAGE;
  25   2                 ECON=EE_WRITE_PAGE;
  26   2                
  27   2                 addr++;
  28   2         }
  29   1      
  30   1         return i;
  31   1      }
  32          //----------------------------------------------------------------------------------
  33          unsigned int EEPROM_Read(void *buffer,unsigned int len,unsigned int addr) //using 0//прочитать несколько с
             -траниц с адреса
  34          {
  35   1      //небезопасная
  36   1      
  37   1        unsigned int  i=0;
  38   1        unsigned char *buf;
  39   1      
  40   1        if (addr+len>= EEMEM_SIZE) //если адрес выходит за границы
  41   1              return (0UL);
  42   1      
  43   1         buf=buffer;
  44   1              
  45   1         for(i=0;i<len;i++)
  46   1         {
  47   2                 EADR=addr;
  48   2                 ECON=EE_READ_PAGE;
  49   2                 
  50   2                 buf[i*4]  =EDATA1; 
  51   2                 buf[i*4+1]=EDATA2; 
  52   2                 buf[i*4+2]=EDATA3; 
C51 COMPILER V9.00   EEPROM                                                                04/24/2015 12:10:34 PAGE 2   

  53   2                 buf[i*4+3]=EDATA4; 
  54   2                 addr++;
  55   2         }  
  56   1      
  57   1         return i;
  58   1      }
  59          
  60          //----------------------------------------------------------------------------------


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    396    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----      18
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
