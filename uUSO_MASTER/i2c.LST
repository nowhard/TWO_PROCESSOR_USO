C51 COMPILER V9.00   I2C                                                                   05/22/2015 09:20:44 PAGE 1   


C51 COMPILER V9.00, COMPILATION OF MODULE I2C
OBJECT MODULE PLACED IN i2c.OBJ
COMPILER INVOKED BY: C:\Program Files\Keil\C51\BIN\C51.EXE i2c.c LARGE OPTIMIZE(6,SPEED) BROWSE ORDER NOAREGS DEBUG OBJE
                    -CTEXTEND CODE SYMBOLS

line level    source

   1          #include "i2c.h"
   2          #include "crc_table.h"//для crc
   3          #include "channels.h"
*** WARNING C318 IN LINE 3 OF i2c.c: can't open file 'channels.h'
   4          #include "watchdog.h"
   5          //-------------------------------------------------------------
   6          
   7          volatile unsigned char xdata DEV_ADDR;
   8          
   9          volatile unsigned char xdata byte_num_write=0;//количество байт в массиве
  10          volatile unsigned char xdata byte_num_read=0;//количество байт в массиве(при вторичном старте)
  11          volatile unsigned char *i2c_buf;//
  12          
  13          //volatile unsigned char xdata repeated_strt_read=0, i2c_address_write=0;
  14          volatile unsigned char  temp_val=0x12;
  15          volatile unsigned char i2c_mas[10]={0};
  16          
  17          
  18          volatile struct I2C_Channel xdata i2c_channels;
  19          
  20          unsigned char idata i2c_buffer[6]={0};
  21          
  22          extern volatile unsigned char xdata  STATE_BYTE;
  23          extern unsigned char channel_number;//количество каналов
  24          
  25          //-------------------------------------------------------------
  26          volatile unsigned char START_I2C=0;
  27          
  28          volatile unsigned char ERROR_I2C=0;
  29          
  30          struct pt pt_i2c_read_buf, pt_i2c_write_buf,pt_i2c_read_complete;
  31          
  32          static PT_THREAD(I2C_Read_Buf(struct pt *pt,unsigned char *buf,unsigned char len));//дочерний поток чтения
             - буфера I2C
  33          static PT_THREAD(I2C_Write_Buf(struct pt *pt,unsigned char *buf,unsigned char len));//дочерний поток запис
             -и буфера I2C
  34          static PT_THREAD(I2C_Read_Complete(struct pt *pt));//постобработка пакета
  35          //-------------------------------------------------------------
  36          
  37          //-------------------------------------------------------------
  38          
  39          void I2C_Init(void)
  40          {
  41   1              I2CM=1;//ведущий
  42   1              PT_INIT(&pt_i2c_read_buf);//инициализация дочерних потоков
  43   1              PT_INIT(&pt_i2c_write_buf);
  44   1              PT_INIT(&pt_i2c_read_complete);
  45   1      
  46   1              return;
  47   1      }
  48          //--------------------------------------------------------------
  49          void I2C_Repeat_Start_Read(unsigned char addr,unsigned char *par_buf,unsigned char par_buf_len,unsigned ch
             -ar *buf,unsigned char buf_len)//запрос с двумя стартами
  50          {
C51 COMPILER V9.00   I2C                                                                   05/22/2015 09:20:44 PAGE 2   

  51   1      
  52   1      
  53   1              DEV_ADDR=(addr<<1)&0xFE;
  54   1      
  55   1              
  56   1              byte_num_write=par_buf_len;
  57   1              byte_num_read=buf_len;
  58   1              
  59   1              i2c_buf=par_buf;
  60   1              //repeated_strt_read=1;
  61   1              START_I2C=1;//стартуем
  62   1              
  63   1              return;
  64   1      }
*** WARNING C280 IN LINE 49 OF I2C.C: 'buf': unreferenced local variable
  65          //-------------------------------------------------------------
  66          //#pragma OT(0,Speed) 
  67           PT_THREAD(I2C_Process(struct pt *pt))//поток  I2C
  68           { 
  69   1         wdt_count[I2C_Proc].process_state=RUN; 
  70   1      
  71   1         PT_BEGIN(pt);
  72   3      
  73   3        while(1) 
  74   3        {
  75   4               
  76   4               PT_WAIT_UNTIL(pt,START_I2C);
  77   4               START_I2C=0;
  78   4      
  79   4      //       //--------------start---------------
  80   4               MDE=1; //software output enable
  81   4      
  82   4      
  83   4                 //-------I2C START--------
  84   4                       MCO=0;
  85   4                   MDO=1;                                
  86   4                       MCO=1;                            
  87   4                       PT_YIELD(pt);//дадим другим процессам время       
  88   4                       MDO=0;                            
  89   4                 //------------------------
  90   4      
  91   4               //-------------передача буфера-------
  92   4      
  93   4               PT_SPAWN(pt, &pt_i2c_write_buf, I2C_Write_Buf(&pt_i2c_write_buf,&DEV_ADDR,1)); //передаем адрес
  94   4      
  95   4      
  96   4                if(ERROR_I2C)//смотрим ошибки
  97   4                {
  98   5                        //-------I2C STOP--------
  99   5                              MCO=0;
 100   5                          MDO=0;                                      
 101   5                              MCO=1;                          
 102   5                              PT_YIELD(pt);//дадим другим процессам время                                                                             
 103   5                              MDO=1;
 104   5                        //------------------------
 105   5                          ERROR_I2C=0;                        
 106   5                              PT_RESTART(pt); 
 107   5                }
 108   4                //PT_YIELD(pt);//дадим другим процессам время
 109   4        //--------------------------------------------------------------------------------------------------
 110   4                
 111   4                //i2c_buf[0]=0x8;
C51 COMPILER V9.00   I2C                                                                   05/22/2015 09:20:44 PAGE 3   

 112   4      
 113   4                PT_SPAWN(pt, &pt_i2c_write_buf, I2C_Write_Buf(&pt_i2c_write_buf,&i2c_buffer/*i2c_buf*/,byte_num_write))
             -; //передаем параметры
 114   4                if(ERROR_I2C)//смотрим ошибки
 115   4                {
 116   5                        //-------I2C STOP--------
 117   5                              MCO=0;
 118   5                          MDO=0;                                      
 119   5                              MCO=1;                          
 120   5                              PT_YIELD(pt);//дадим другим процессам время                                                                             
 121   5                              MDO=1;
 122   5                        //------------------------
 123   5                              ERROR_I2C=0;                    
 124   5                              PT_RESTART(pt); 
 125   5                }
 126   4                //PT_YIELD(pt);//дадим другим процессам время
 127   4      ////------------------------------------------------------------------------------------------------------
 128   4                //-----------повторный старт--------
 129   4                 //-------I2C START--------
 130   4                       MCO=0;
 131   4                   MDO=1;                                
 132   4                       MCO=1;                            
 133   4                       PT_YIELD(pt);//дадим другим процессам время       
 134   4                       MDO=0;                            
 135   4                 //------------------------
 136   4                DEV_ADDR|=1;
 137   4      
 138   4      
 139   4                PT_SPAWN(pt, &pt_i2c_write_buf, I2C_Write_Buf(&pt_i2c_write_buf,&DEV_ADDR,1)); //передаем адрес
 140   4      
 141   4                if(ERROR_I2C)//смотрим ошибки
 142   4                {
 143   5                        //-------I2C STOP--------
 144   5                              MCO=0;
 145   5                          MDO=0;                                      
 146   5                              MCO=1;  
 147   5                              PT_YIELD(pt);//дадим другим процессам время                                                                             
 148   5                              MDO=1;
 149   5                        //------------------------
 150   5                          ERROR_I2C=0;                
 151   5                              PT_RESTART(pt); 
 152   5                }
 153   4               // PT_YIELD(pt);//дадим другим процессам время
 154   4       //-------------------------------------------------------------------------------------------------------
             ---------------
 155   4                PT_SPAWN(pt, &pt_i2c_read_buf, I2C_Read_Buf(&pt_i2c_read_buf,&i2c_channels.I2C_CHNL.i2c_buf,byte_num_re
             -ad)); //принимаем данные
 156   4                if(ERROR_I2C)//смотрим ошибки
 157   4                {
 158   5                        //-------I2C STOP--------
 159   5                              MCO=0;
 160   5                          MDO=0;                                      
 161   5                              MCO=1;                                  
 162   5                              PT_YIELD(pt);//дадим другим процессам время                                                                     
 163   5                              MDO=1;
 164   5                        //------------------------
 165   5                              ERROR_I2C=0;                    
 166   5                              PT_RESTART(pt); 
 167   5                }
 168   4               // PT_YIELD(pt);//дадим другим процессам время
 169   4      
 170   4                //-------I2C STOP--------
C51 COMPILER V9.00   I2C                                                                   05/22/2015 09:20:44 PAGE 4   

 171   4                      MCO=0;
 172   4                  MDO=0;                                      
 173   4                      MCO=1;
 174   4                      PT_YIELD(pt);//дадим другим процессам время                                                                     
 175   4                      MDO=1;
 176   4      
 177   4                //-----------------------------------------------------------------------------
 178   4      
 179   4                PT_SPAWN(pt, &pt_i2c_read_complete, I2C_Read_Complete(&pt_i2c_read_complete));
 180   4      
 181   4               //----------------------------------
 182   4                wdt_count[I2C_Proc].count++;
 183   4        }
 184   3        PT_END(pt);
 185   1      
 186   1       }
 187          //-------------------------------------------------------------
 188          //#pragma OT(0,Speed)
 189           static PT_THREAD(I2C_Read_Buf(struct pt *pt,unsigned char *buf,unsigned char len))//дочерний поток чтения
             - буфера I2C
 190           {  
 191   1                  static volatile unsigned char read_byte_counter,bit_counter,recieve_byte;
 192   1                 
 193   1                PT_BEGIN(pt);
 194   3                
 195   3                read_byte_counter=0;
 196   3      
 197   3                while(read_byte_counter<len) //цикл приема буфера
 198   3                {     
 199   4                              recieve_byte=0;
 200   4                              MDE=0;//прием 
 201   4                              MCO=0;
 202   4                              PT_YIELD(pt);//дадим другим процессам время
 203   4                              for(bit_counter=0;bit_counter<8;bit_counter++) //цикл приема байта
 204   4                              {
 205   5                                      MCO=1;
 206   5      
 207   5                                      //PT_YIELD(pt);//дадим другим процессам время
 208   5                                      recieve_byte=(recieve_byte<<1)|MDI;
 209   5                                      MCO=0;
 210   5                              } //приняли байт
 211   4                              
 212   4                              buf[read_byte_counter]=recieve_byte;
 213   4                              read_byte_counter++;
 214   4      
 215   4      
 216   4                              MDE=1;//на передачу и отсылаем ACK
 217   4                              if(read_byte_counter<len) //ack
 218   4                              {
 219   5                                              //ACK   
 220   5                                      MDO=0;
 221   5      
 222   5                              }
 223   4                              else  //nack
 224   4                              {
 225   5                                      //NACK          
 226   5                                      MDO=1;                  
 227   5                              }
 228   4                                      
 229   4                              MCO=1;
 230   4                              PT_YIELD(pt);//дадим другим процессам время
 231   4                              MCO=0;
C51 COMPILER V9.00   I2C                                                                   05/22/2015 09:20:44 PAGE 5   

 232   4                                      
 233   4                              MDE=0;//прием
 234   4      
 235   4                }
 236   3                MDE=1;
 237   3                ERROR_I2C=0;
 238   3                PT_END(pt);
 239   1      }
 240          //-------------------------------------------------------------
 241          //#pragma OT(0,Speed)
 242          static PT_THREAD(I2C_Write_Buf(struct pt *pt,unsigned char *buf,unsigned char len))//дочерний поток записи
             - буфера I2C
 243           {  
 244   1                 static volatile unsigned char write_byte_counter,bit_counter,write_byte;
 245   1                PT_BEGIN(pt);
 246   3                MDE=1;//передача 
 247   3                write_byte_counter=0;
 248   3                while(write_byte_counter<len)  //цикл передачи буфера
 249   3                {
 250   4                      //      bit_counter=0;
 251   4      
 252   4                              write_byte=buf[write_byte_counter];
 253   4                              write_byte_counter++;
 254   4                              MCO=0;
 255   4                              PT_YIELD(pt);//дадим другим процессам время
 256   4                              for(bit_counter=0;bit_counter<8;bit_counter++)
 257   4                              {
 258   5                                      
 259   5                                      write_byte=write_byte<<1;//>>1;  //???
 260   5                                      MDO=CY;
 261   5                              
 262   5                                      MCO=1;
 263   5                                      PT_YIELD(pt);//дадим другим процессам время
 264   5                                      MCO=0;
 265   5      //                              PT_YIELD(pt);//дадим другим процессам время
 266   5      
 267   5                              }
 268   4                              MDE=0;//прием 
 269   4                              MCO=0;
 270   4                              PT_YIELD(pt);//дадим другим процессам время
 271   4                              MCO=1;
 272   4                              PT_YIELD(pt);//дадим другим процессам время
 273   4                              MCO=0;  
 274   4                              MDE=1;//передача
 275   4                              if(MDI) //NACK
 276   4                              {
 277   5                                      ERROR_I2C=1;//случилась ошибка  
 278   5                                      PT_EXIT(pt);
 279   5                              }
 280   4                }
 281   3                ERROR_I2C=0;
 282   3                PT_END(pt);
 283   1      }
 284          //-------------------------------------------------------------
 285          static PT_THREAD(I2C_Read_Complete(struct pt *pt))//постобработка пакета
 286          {
 287   1              PT_BEGIN(pt);
 288   3         if(i2c_channels.I2C_CHNL.channels.CRC==CRC_Check(i2c_channels.I2C_CHNL.i2c_buf,10))
 289   3         {
 290   4              //channels[11].channel_data=i2c_channels.I2C_CHNL.channels.DOL;
 291   4      
 292   4      
C51 COMPILER V9.00   I2C                                                                   05/22/2015 09:20:44 PAGE 6   

 293   4              switch(i2c_channels.I2C_CHNL.channels.frequency_modific)  //изменяем тип канала согласно ведомому
 294   4              {
 295   5                      case  CHNL_FREQ_256:
 296   5                      {
 297   6                                      channels[CHNL_FREQ_COUNT_T_0].channel_data=i2c_channels.I2C_CHNL.channels.frequency;
 298   6                                      channels[CHNL_FREQ_COUNT_T_0].settings.set.modific=CHNL_FREQ_256;
 299   6                                      channel_number=CHANNEL_NUMBER-1; //удаляем канал усреднения высокой частоты
 300   6                                      
 301   6                      }
 302   5                      break;
 303   5      
 304   5                      case CHNL_FREQ_COUNT_T:
 305   5                      {
 306   6                                      channels[CHNL_FREQ_COUNT_T_0].channel_data=i2c_channels.I2C_CHNL.channels.frequency;
 307   6                                      channels[CHNL_FREQ_COUNT_T_1].channel_data=i2c_channels.I2C_CHNL.channels.mid_frequency;
 308   6                                      channels[CHNL_FREQ_COUNT_T_0].settings.set.modific=CHNL_FREQ_COUNT_T;
 309   6                                      channel_number=CHANNEL_NUMBER; //все каналы задействованы
 310   6                      }
 311   5                      break;
 312   5      
 313   5                      default:
 314   5                      {
 315   6                      }
 316   5                      break;
 317   5              }
 318   4      
 319   4              STATE_BYTE|=i2c_channels.I2C_CHNL.channels.state_byte;//обновляем байт состояния
 320   4         }
 321   3         i2c_buffer[0]=0;//не сбрасывать флаг инициализации
 322   3              
 323   3              PT_END(pt);     
 324   1      }
C51 COMPILER V9.00   I2C                                                                   05/22/2015 09:20:44 PAGE 7   

ASSEMBLY LISTING OF GENERATED OBJECT CODE


             ; FUNCTION I2C_Init (BEGIN)
                                           ; SOURCE LINE # 39
                                           ; SOURCE LINE # 40
                                           ; SOURCE LINE # 41
0000 D2EB              SETB    I2CM
                                           ; SOURCE LINE # 42
0002 E4                CLR     A
0003 900000      R     MOV     DPTR,#pt_i2c_read_buf
0006 F0                MOVX    @DPTR,A
0007 A3                INC     DPTR
0008 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 43
0009 900000      R     MOV     DPTR,#pt_i2c_write_buf
000C F0                MOVX    @DPTR,A
000D A3                INC     DPTR
000E F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 44
000F 900000      R     MOV     DPTR,#pt_i2c_read_complete
0012 F0                MOVX    @DPTR,A
0013 A3                INC     DPTR
0014 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 47
0015         ?C0001:
0015 22                RET     
             ; FUNCTION I2C_Init (END)

             ; FUNCTION _I2C_Repeat_Start_Read (BEGIN)
                                           ; SOURCE LINE # 49
;---- Variable 'par_buf' assigned to Register 'R1/R2/R3' ----
;---- Variable 'addr' assigned to Register 'R7' ----
                                           ; SOURCE LINE # 50
                                           ; SOURCE LINE # 53
0000 EF                MOV     A,R7
0001 25E0              ADD     A,ACC
0003 54FE              ANL     A,#0FEH
0005 900000      R     MOV     DPTR,#DEV_ADDR
0008 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 56
0009 900000      R     MOV     DPTR,#par_buf_len
000C E0                MOVX    A,@DPTR
000D 900000      R     MOV     DPTR,#byte_num_write
0010 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 57
0011 900000      R     MOV     DPTR,#buf_len
0014 E0                MOVX    A,@DPTR
0015 900000      R     MOV     DPTR,#byte_num_read
0018 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 59
0019 A3                INC     DPTR
001A EB                MOV     A,R3
001B F0                MOVX    @DPTR,A
001C A3                INC     DPTR
001D EA                MOV     A,R2
001E F0                MOVX    @DPTR,A
001F A3                INC     DPTR
0020 E9                MOV     A,R1
0021 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 61
0022 900000      R     MOV     DPTR,#START_I2C
C51 COMPILER V9.00   I2C                                                                   05/22/2015 09:20:44 PAGE 8   

0025 7401              MOV     A,#01H
0027 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 64
0028         ?C0002:
0028 22                RET     
             ; FUNCTION _I2C_Repeat_Start_Read (END)

             ; FUNCTION _I2C_Process (BEGIN)
                                           ; SOURCE LINE # 67
0000 900000      R     MOV     DPTR,#pt
0003 EB                MOV     A,R3
0004 F0                MOVX    @DPTR,A
0005 A3                INC     DPTR
0006 EA                MOV     A,R2
0007 F0                MOVX    @DPTR,A
0008 A3                INC     DPTR
0009 E9                MOV     A,R1
000A F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 68
                                           ; SOURCE LINE # 69
000B E4                CLR     A
000C 900000      E     MOV     DPTR,#wdt_count+0FH
000F F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 71
0010 900000      R     MOV     DPTR,#PT_YIELD_FLAG
0013 04                INC     A
0014 F0                MOVX    @DPTR,A
0015 120000      E     LCALL   ?C?ILDPTR
0018 FF                MOV     R7,A
0019 AEF0              MOV     R6,B
001B E5F0              MOV     A,B
001D 6003              JZ      $ + 5H
001F 020000      R     LJMP    ?C0003
0022 EF                MOV     A,R7
0023 120000      E     LCALL   ?C?CCASE
0026 0000        R     DW      ?C0009
0028 00                DB      00H
0029 0000        R     DW      ?C0010
002B 4C                DB      04CH
002C 0000        R     DW      ?C0016
002E 57                DB      057H
002F 0000        R     DW      ?C0024
0031 5D                DB      05DH
0032 0000        R     DW      ?C0032
0034 66                DB      066H
0035 0000        R     DW      ?C0043
0037 71                DB      071H
0038 0000        R     DW      ?C0051
003A 78                DB      078H
003B 0000        R     DW      ?C0059
003D 85                DB      085H
003E 0000        R     DW      ?C0067
0040 8B                DB      08BH
0041 0000        R     DW      ?C0075
0043 93                DB      093H
0044 0000        R     DW      ?C0086
0046 9B                DB      09BH
0047 0000        R     DW      ?C0094
0049 A2                DB      0A2H
004A 0000        R     DW      ?C0102
004C AE                DB      0AEH
004D 0000        R     DW      ?C0110
C51 COMPILER V9.00   I2C                                                                   05/22/2015 09:20:44 PAGE 9   

004F B3                DB      0B3H
0050 0000              DW      00H
0052 0000        R     DW      ?C0003
                                           ; SOURCE LINE # 73
                                           ; SOURCE LINE # 74
0054         ?C0009:
                                           ; SOURCE LINE # 76
0054 900000      R     MOV     DPTR,#pt
0057 E0                MOVX    A,@DPTR
0058 FB                MOV     R3,A
0059 A3                INC     DPTR
005A E0                MOVX    A,@DPTR
005B FA                MOV     R2,A
005C A3                INC     DPTR
005D E0                MOVX    A,@DPTR
005E F9                MOV     R1,A
005F E4                CLR     A
0060 75F04C            MOV     B,#04CH
0063 120000      E     LCALL   ?C?ISTPTR
0066         ?C0010:
0066 900000      R     MOV     DPTR,#START_I2C
0069 E0                MOVX    A,@DPTR
006A 7002              JNZ     ?C0008
006C FF                MOV     R7,A
006D 22                RET     
006E         ?C0008:
                                           ; SOURCE LINE # 77
006E E4                CLR     A
006F 900000      R     MOV     DPTR,#START_I2C
0072 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 80
0073 D2EE              SETB    MDE
                                           ; SOURCE LINE # 84
0075 C2ED              CLR     MCO
                                           ; SOURCE LINE # 85
0077 D2EF              SETB    MDO
                                           ; SOURCE LINE # 86
0079 D2ED              SETB    MCO
                                           ; SOURCE LINE # 87
007B 900000      R     MOV     DPTR,#PT_YIELD_FLAG
007E F0                MOVX    @DPTR,A
007F 900000      R     MOV     DPTR,#pt
0082 E0                MOVX    A,@DPTR
0083 FB                MOV     R3,A
0084 A3                INC     DPTR
0085 E0                MOVX    A,@DPTR
0086 FA                MOV     R2,A
0087 A3                INC     DPTR
0088 E0                MOVX    A,@DPTR
0089 F9                MOV     R1,A
008A E4                CLR     A
008B 75F057            MOV     B,#057H
008E 120000      E     LCALL   ?C?ISTPTR
0091         ?C0016:
0091 900000      R     MOV     DPTR,#PT_YIELD_FLAG
0094 E0                MOVX    A,@DPTR
0095 7003              JNZ     ?C0014
0097 7F01              MOV     R7,#01H
0099 22                RET     
009A         ?C0014:
                                           ; SOURCE LINE # 88
009A C2EF              CLR     MDO
C51 COMPILER V9.00   I2C                                                                   05/22/2015 09:20:44 PAGE 10  

                                           ; SOURCE LINE # 93
009C E4                CLR     A
009D 900000      R     MOV     DPTR,#pt_i2c_write_buf
00A0 F0                MOVX    @DPTR,A
00A1 A3                INC     DPTR
00A2 F0                MOVX    @DPTR,A
00A3 900000      R     MOV     DPTR,#pt
00A6 E0                MOVX    A,@DPTR
00A7 FB                MOV     R3,A
00A8 A3                INC     DPTR
00A9 E0                MOVX    A,@DPTR
00AA FA                MOV     R2,A
00AB A3                INC     DPTR
00AC E0                MOVX    A,@DPTR
00AD F9                MOV     R1,A
00AE E4                CLR     A
00AF 75F05D            MOV     B,#05DH
00B2 120000      E     LCALL   ?C?ISTPTR
00B5         ?C0024:
00B5 7A00        R     MOV     R2,#HIGH DEV_ADDR
00B7 7900        R     MOV     R1,#LOW DEV_ADDR
00B9 900000      R     MOV     DPTR,#?_I2C_Write_Buf?BYTE+03H
00BC 7401              MOV     A,#01H
00BE F0                MOVX    @DPTR,A
00BF A3                INC     DPTR
00C0 7400        R     MOV     A,#HIGH DEV_ADDR
00C2 F0                MOVX    @DPTR,A
00C3 A3                INC     DPTR
00C4 7400        R     MOV     A,#LOW DEV_ADDR
00C6 F0                MOVX    @DPTR,A
00C7 A3                INC     DPTR
00C8 7401              MOV     A,#01H
00CA F0                MOVX    @DPTR,A
00CB FB                MOV     R3,A
00CC 7A00        R     MOV     R2,#HIGH pt_i2c_write_buf
00CE 7900        R     MOV     R1,#LOW pt_i2c_write_buf
00D0 120000      R     LCALL   _I2C_Write_Buf
00D3 C3                CLR     C
00D4 EF                MOV     A,R7
00D5 6480              XRL     A,#080H
00D7 9482              SUBB    A,#082H
00D9 5002              JNC     ?C0026
00DB 8001              SJMP    ?C0027
00DD         ?C0026:
00DD C3                CLR     C
00DE         ?C0027:
00DE 5003              JNC     ?C0019
00E0 7F00              MOV     R7,#00H
00E2 22                RET     
00E3         ?C0019:
                                           ; SOURCE LINE # 96
00E3 900000      R     MOV     DPTR,#ERROR_I2C
00E6 E0                MOVX    A,@DPTR
00E7 6041              JZ      ?C0039
                                           ; SOURCE LINE # 97
                                           ; SOURCE LINE # 99
00E9 C2ED              CLR     MCO
                                           ; SOURCE LINE # 100
00EB C2EF              CLR     MDO
                                           ; SOURCE LINE # 101
00ED D2ED              SETB    MCO
                                           ; SOURCE LINE # 102
C51 COMPILER V9.00   I2C                                                                   05/22/2015 09:20:44 PAGE 11  

00EF E4                CLR     A
00F0 900000      R     MOV     DPTR,#PT_YIELD_FLAG
00F3 F0                MOVX    @DPTR,A
00F4 900000      R     MOV     DPTR,#pt
00F7 E0                MOVX    A,@DPTR
00F8 FB                MOV     R3,A
00F9 A3                INC     DPTR
00FA E0                MOVX    A,@DPTR
00FB FA                MOV     R2,A
00FC A3                INC     DPTR
00FD E0                MOVX    A,@DPTR
00FE F9                MOV     R1,A
00FF E4                CLR     A
0100 75F066            MOV     B,#066H
0103 120000      E     LCALL   ?C?ISTPTR
0106         ?C0032:
0106 900000      R     MOV     DPTR,#PT_YIELD_FLAG
0109 E0                MOVX    A,@DPTR
010A 7003              JNZ     ?C0030
010C 7F01              MOV     R7,#01H
010E 22                RET     
010F         ?C0030:
                                           ; SOURCE LINE # 103
010F D2EF              SETB    MDO
                                           ; SOURCE LINE # 105
0111 E4                CLR     A
0112 900000      R     MOV     DPTR,#ERROR_I2C
0115 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 106
0116 900000      R     MOV     DPTR,#pt
0119 E0                MOVX    A,@DPTR
011A FB                MOV     R3,A
011B A3                INC     DPTR
011C E0                MOVX    A,@DPTR
011D FA                MOV     R2,A
011E A3                INC     DPTR
011F E0                MOVX    A,@DPTR
0120 F9                MOV     R1,A
0121 E4                CLR     A
0122 F5F0              MOV     B,A
0124 120000      E     LCALL   ?C?ISTPTR
0127 7F00              MOV     R7,#00H
0129 22                RET     
                                           ; SOURCE LINE # 107
012A         ?C0039:
                                           ; SOURCE LINE # 113
012A E4                CLR     A
012B 900000      R     MOV     DPTR,#pt_i2c_write_buf
012E F0                MOVX    @DPTR,A
012F A3                INC     DPTR
0130 F0                MOVX    @DPTR,A
0131 900000      R     MOV     DPTR,#pt
0134 E0                MOVX    A,@DPTR
0135 FB                MOV     R3,A
0136 A3                INC     DPTR
0137 E0                MOVX    A,@DPTR
0138 FA                MOV     R2,A
0139 A3                INC     DPTR
013A E0                MOVX    A,@DPTR
013B F9                MOV     R1,A
013C E4                CLR     A
013D 75F071            MOV     B,#071H
C51 COMPILER V9.00   I2C                                                                   05/22/2015 09:20:44 PAGE 12  

0140 120000      E     LCALL   ?C?ISTPTR
0143         ?C0043:
0143 900000      R     MOV     DPTR,#?_I2C_Write_Buf?BYTE+03H
0146 E4                CLR     A
0147 F0                MOVX    @DPTR,A
0148 A3                INC     DPTR
0149 7400        R     MOV     A,#HIGH i2c_buffer
014B F0                MOVX    @DPTR,A
014C A3                INC     DPTR
014D 7400        R     MOV     A,#LOW i2c_buffer
014F F0                MOVX    @DPTR,A
0150 900000      R     MOV     DPTR,#byte_num_write
0153 E0                MOVX    A,@DPTR
0154 900000      R     MOV     DPTR,#?_I2C_Write_Buf?BYTE+06H
0157 F0                MOVX    @DPTR,A
0158 7B01              MOV     R3,#01H
015A 7A00        R     MOV     R2,#HIGH pt_i2c_write_buf
015C 7900        R     MOV     R1,#LOW pt_i2c_write_buf
015E 120000      R     LCALL   _I2C_Write_Buf
0161 C3                CLR     C
0162 EF                MOV     A,R7
0163 6480              XRL     A,#080H
0165 9482              SUBB    A,#082H
0167 5002              JNC     ?C0045
0169 8001              SJMP    ?C0046
016B         ?C0045:
016B C3                CLR     C
016C         ?C0046:
016C 5003              JNC     ?C0038
016E 7F00              MOV     R7,#00H
0170 22                RET     
0171         ?C0038:
                                           ; SOURCE LINE # 114
0171 900000      R     MOV     DPTR,#ERROR_I2C
0174 E0                MOVX    A,@DPTR
0175 6041              JZ      ?C0047
                                           ; SOURCE LINE # 115
                                           ; SOURCE LINE # 117
0177 C2ED              CLR     MCO
                                           ; SOURCE LINE # 118
0179 C2EF              CLR     MDO
                                           ; SOURCE LINE # 119
017B D2ED              SETB    MCO
                                           ; SOURCE LINE # 120
017D E4                CLR     A
017E 900000      R     MOV     DPTR,#PT_YIELD_FLAG
0181 F0                MOVX    @DPTR,A
0182 900000      R     MOV     DPTR,#pt
0185 E0                MOVX    A,@DPTR
0186 FB                MOV     R3,A
0187 A3                INC     DPTR
0188 E0                MOVX    A,@DPTR
0189 FA                MOV     R2,A
018A A3                INC     DPTR
018B E0                MOVX    A,@DPTR
018C F9                MOV     R1,A
018D E4                CLR     A
018E 75F078            MOV     B,#078H
0191 120000      E     LCALL   ?C?ISTPTR
0194         ?C0051:
0194 900000      R     MOV     DPTR,#PT_YIELD_FLAG
0197 E0                MOVX    A,@DPTR
C51 COMPILER V9.00   I2C                                                                   05/22/2015 09:20:44 PAGE 13  

0198 7003              JNZ     ?C0049
019A 7F01              MOV     R7,#01H
019C 22                RET     
019D         ?C0049:
                                           ; SOURCE LINE # 121
019D D2EF              SETB    MDO
                                           ; SOURCE LINE # 123
019F E4                CLR     A
01A0 900000      R     MOV     DPTR,#ERROR_I2C
01A3 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 124
01A4 900000      R     MOV     DPTR,#pt
01A7 E0                MOVX    A,@DPTR
01A8 FB                MOV     R3,A
01A9 A3                INC     DPTR
01AA E0                MOVX    A,@DPTR
01AB FA                MOV     R2,A
01AC A3                INC     DPTR
01AD E0                MOVX    A,@DPTR
01AE F9                MOV     R1,A
01AF E4                CLR     A
01B0 F5F0              MOV     B,A
01B2 120000      E     LCALL   ?C?ISTPTR
01B5 7F00              MOV     R7,#00H
01B7 22                RET     
                                           ; SOURCE LINE # 125
01B8         ?C0047:
                                           ; SOURCE LINE # 130
01B8 C2ED              CLR     MCO
                                           ; SOURCE LINE # 131
01BA D2EF              SETB    MDO
                                           ; SOURCE LINE # 132
01BC D2ED              SETB    MCO
                                           ; SOURCE LINE # 133
01BE E4                CLR     A
01BF 900000      R     MOV     DPTR,#PT_YIELD_FLAG
01C2 F0                MOVX    @DPTR,A
01C3 900000      R     MOV     DPTR,#pt
01C6 E0                MOVX    A,@DPTR
01C7 FB                MOV     R3,A
01C8 A3                INC     DPTR
01C9 E0                MOVX    A,@DPTR
01CA FA                MOV     R2,A
01CB A3                INC     DPTR
01CC E0                MOVX    A,@DPTR
01CD F9                MOV     R1,A
01CE E4                CLR     A
01CF 75F085            MOV     B,#085H
01D2 120000      E     LCALL   ?C?ISTPTR
01D5         ?C0059:
01D5 900000      R     MOV     DPTR,#PT_YIELD_FLAG
01D8 E0                MOVX    A,@DPTR
01D9 7003              JNZ     ?C0057
01DB 7F01              MOV     R7,#01H
01DD 22                RET     
01DE         ?C0057:
                                           ; SOURCE LINE # 134
01DE C2EF              CLR     MDO
                                           ; SOURCE LINE # 136
01E0 900000      R     MOV     DPTR,#DEV_ADDR
01E3 E0                MOVX    A,@DPTR
01E4 4401              ORL     A,#01H
C51 COMPILER V9.00   I2C                                                                   05/22/2015 09:20:44 PAGE 14  

01E6 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 139
01E7 E4                CLR     A
01E8 900000      R     MOV     DPTR,#pt_i2c_write_buf
01EB F0                MOVX    @DPTR,A
01EC A3                INC     DPTR
01ED F0                MOVX    @DPTR,A
01EE 900000      R     MOV     DPTR,#pt
01F1 E0                MOVX    A,@DPTR
01F2 FB                MOV     R3,A
01F3 A3                INC     DPTR
01F4 E0                MOVX    A,@DPTR
01F5 FA                MOV     R2,A
01F6 A3                INC     DPTR
01F7 E0                MOVX    A,@DPTR
01F8 F9                MOV     R1,A
01F9 E4                CLR     A
01FA 75F08B            MOV     B,#08BH
01FD 120000      E     LCALL   ?C?ISTPTR
0200         ?C0067:
0200 7A00        R     MOV     R2,#HIGH DEV_ADDR
0202 7900        R     MOV     R1,#LOW DEV_ADDR
0204 900000      R     MOV     DPTR,#?_I2C_Write_Buf?BYTE+03H
0207 7401              MOV     A,#01H
0209 F0                MOVX    @DPTR,A
020A A3                INC     DPTR
020B 7400        R     MOV     A,#HIGH DEV_ADDR
020D F0                MOVX    @DPTR,A
020E A3                INC     DPTR
020F 7400        R     MOV     A,#LOW DEV_ADDR
0211 F0                MOVX    @DPTR,A
0212 A3                INC     DPTR
0213 7401              MOV     A,#01H
0215 F0                MOVX    @DPTR,A
0216 FB                MOV     R3,A
0217 7A00        R     MOV     R2,#HIGH pt_i2c_write_buf
0219 7900        R     MOV     R1,#LOW pt_i2c_write_buf
021B 120000      R     LCALL   _I2C_Write_Buf
021E C3                CLR     C
021F EF                MOV     A,R7
0220 6480              XRL     A,#080H
0222 9482              SUBB    A,#082H
0224 5002              JNC     ?C0069
0226 8001              SJMP    ?C0070
0228         ?C0069:
0228 C3                CLR     C
0229         ?C0070:
0229 5003              JNC     ?C0062
022B 7F00              MOV     R7,#00H
022D 22                RET     
022E         ?C0062:
                                           ; SOURCE LINE # 141
022E 900000      R     MOV     DPTR,#ERROR_I2C
0231 E0                MOVX    A,@DPTR
0232 6041              JZ      ?C0082
                                           ; SOURCE LINE # 142
                                           ; SOURCE LINE # 144
0234 C2ED              CLR     MCO
                                           ; SOURCE LINE # 145
0236 C2EF              CLR     MDO
                                           ; SOURCE LINE # 146
0238 D2ED              SETB    MCO
C51 COMPILER V9.00   I2C                                                                   05/22/2015 09:20:44 PAGE 15  

                                           ; SOURCE LINE # 147
023A E4                CLR     A
023B 900000      R     MOV     DPTR,#PT_YIELD_FLAG
023E F0                MOVX    @DPTR,A
023F 900000      R     MOV     DPTR,#pt
0242 E0                MOVX    A,@DPTR
0243 FB                MOV     R3,A
0244 A3                INC     DPTR
0245 E0                MOVX    A,@DPTR
0246 FA                MOV     R2,A
0247 A3                INC     DPTR
0248 E0                MOVX    A,@DPTR
0249 F9                MOV     R1,A
024A E4                CLR     A
024B 75F093            MOV     B,#093H
024E 120000      E     LCALL   ?C?ISTPTR
0251         ?C0075:
0251 900000      R     MOV     DPTR,#PT_YIELD_FLAG
0254 E0                MOVX    A,@DPTR
0255 7003              JNZ     ?C0073
0257 7F01              MOV     R7,#01H
0259 22                RET     
025A         ?C0073:
                                           ; SOURCE LINE # 148
025A D2EF              SETB    MDO
                                           ; SOURCE LINE # 150
025C E4                CLR     A
025D 900000      R     MOV     DPTR,#ERROR_I2C
0260 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 151
0261 900000      R     MOV     DPTR,#pt
0264 E0                MOVX    A,@DPTR
0265 FB                MOV     R3,A
0266 A3                INC     DPTR
0267 E0                MOVX    A,@DPTR
0268 FA                MOV     R2,A
0269 A3                INC     DPTR
026A E0                MOVX    A,@DPTR
026B F9                MOV     R1,A
026C E4                CLR     A
026D F5F0              MOV     B,A
026F 120000      E     LCALL   ?C?ISTPTR
0272 7F00              MOV     R7,#00H
0274 22                RET     
                                           ; SOURCE LINE # 152
0275         ?C0082:
                                           ; SOURCE LINE # 155
0275 E4                CLR     A
0276 900000      R     MOV     DPTR,#pt_i2c_read_buf
0279 F0                MOVX    @DPTR,A
027A A3                INC     DPTR
027B F0                MOVX    @DPTR,A
027C 900000      R     MOV     DPTR,#pt
027F E0                MOVX    A,@DPTR
0280 FB                MOV     R3,A
0281 A3                INC     DPTR
0282 E0                MOVX    A,@DPTR
0283 FA                MOV     R2,A
0284 A3                INC     DPTR
0285 E0                MOVX    A,@DPTR
0286 F9                MOV     R1,A
0287 E4                CLR     A
C51 COMPILER V9.00   I2C                                                                   05/22/2015 09:20:44 PAGE 16  

0288 75F09B            MOV     B,#09BH
028B 120000      E     LCALL   ?C?ISTPTR
028E         ?C0086:
028E 7A00        R     MOV     R2,#HIGH i2c_channels
0290 7900        R     MOV     R1,#LOW i2c_channels
0292 900000      R     MOV     DPTR,#?_I2C_Read_Buf?BYTE+03H
0295 7401              MOV     A,#01H
0297 F0                MOVX    @DPTR,A
0298 A3                INC     DPTR
0299 7400        R     MOV     A,#HIGH i2c_channels
029B F0                MOVX    @DPTR,A
029C A3                INC     DPTR
029D 7400        R     MOV     A,#LOW i2c_channels
029F F0                MOVX    @DPTR,A
02A0 900000      R     MOV     DPTR,#byte_num_read
02A3 E0                MOVX    A,@DPTR
02A4 900000      R     MOV     DPTR,#?_I2C_Read_Buf?BYTE+06H
02A7 F0                MOVX    @DPTR,A
02A8 7B01              MOV     R3,#01H
02AA 7A00        R     MOV     R2,#HIGH pt_i2c_read_buf
02AC 7900        R     MOV     R1,#LOW pt_i2c_read_buf
02AE 120000      R     LCALL   _I2C_Read_Buf
02B1 C3                CLR     C
02B2 EF                MOV     A,R7
02B3 6480              XRL     A,#080H
02B5 9482              SUBB    A,#082H
02B7 5002              JNC     ?C0088
02B9 8001              SJMP    ?C0089
02BB         ?C0088:
02BB C3                CLR     C
02BC         ?C0089:
02BC 5003              JNC     ?C0081
02BE 7F00              MOV     R7,#00H
02C0 22                RET     
02C1         ?C0081:
                                           ; SOURCE LINE # 156
02C1 900000      R     MOV     DPTR,#ERROR_I2C
02C4 E0                MOVX    A,@DPTR
02C5 6041              JZ      ?C0090
                                           ; SOURCE LINE # 157
                                           ; SOURCE LINE # 159
02C7 C2ED              CLR     MCO
                                           ; SOURCE LINE # 160
02C9 C2EF              CLR     MDO
                                           ; SOURCE LINE # 161
02CB D2ED              SETB    MCO
                                           ; SOURCE LINE # 162
02CD E4                CLR     A
02CE 900000      R     MOV     DPTR,#PT_YIELD_FLAG
02D1 F0                MOVX    @DPTR,A
02D2 900000      R     MOV     DPTR,#pt
02D5 E0                MOVX    A,@DPTR
02D6 FB                MOV     R3,A
02D7 A3                INC     DPTR
02D8 E0                MOVX    A,@DPTR
02D9 FA                MOV     R2,A
02DA A3                INC     DPTR
02DB E0                MOVX    A,@DPTR
02DC F9                MOV     R1,A
02DD E4                CLR     A
02DE 75F0A2            MOV     B,#0A2H
02E1 120000      E     LCALL   ?C?ISTPTR
C51 COMPILER V9.00   I2C                                                                   05/22/2015 09:20:44 PAGE 17  

02E4         ?C0094:
02E4 900000      R     MOV     DPTR,#PT_YIELD_FLAG
02E7 E0                MOVX    A,@DPTR
02E8 7003              JNZ     ?C0092
02EA 7F01              MOV     R7,#01H
02EC 22                RET     
02ED         ?C0092:
                                           ; SOURCE LINE # 163
02ED D2EF              SETB    MDO
                                           ; SOURCE LINE # 165
02EF E4                CLR     A
02F0 900000      R     MOV     DPTR,#ERROR_I2C
02F3 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 166
02F4 900000      R     MOV     DPTR,#pt
02F7 E0                MOVX    A,@DPTR
02F8 FB                MOV     R3,A
02F9 A3                INC     DPTR
02FA E0                MOVX    A,@DPTR
02FB FA                MOV     R2,A
02FC A3                INC     DPTR
02FD E0                MOVX    A,@DPTR
02FE F9                MOV     R1,A
02FF E4                CLR     A
0300 F5F0              MOV     B,A
0302 120000      E     LCALL   ?C?ISTPTR
0305 7F00              MOV     R7,#00H
0307 22                RET     
                                           ; SOURCE LINE # 167
0308         ?C0090:
                                           ; SOURCE LINE # 171
0308 C2ED              CLR     MCO
                                           ; SOURCE LINE # 172
030A C2EF              CLR     MDO
                                           ; SOURCE LINE # 173
030C D2ED              SETB    MCO
                                           ; SOURCE LINE # 174
030E E4                CLR     A
030F 900000      R     MOV     DPTR,#PT_YIELD_FLAG
0312 F0                MOVX    @DPTR,A
0313 900000      R     MOV     DPTR,#pt
0316 E0                MOVX    A,@DPTR
0317 FB                MOV     R3,A
0318 A3                INC     DPTR
0319 E0                MOVX    A,@DPTR
031A FA                MOV     R2,A
031B A3                INC     DPTR
031C E0                MOVX    A,@DPTR
031D F9                MOV     R1,A
031E E4                CLR     A
031F 75F0AE            MOV     B,#0AEH
0322 120000      E     LCALL   ?C?ISTPTR
0325         ?C0102:
0325 900000      R     MOV     DPTR,#PT_YIELD_FLAG
0328 E0                MOVX    A,@DPTR
0329 7003              JNZ     ?C0100
032B 7F01              MOV     R7,#01H
032D 22                RET     
032E         ?C0100:
                                           ; SOURCE LINE # 175
032E D2EF              SETB    MDO
                                           ; SOURCE LINE # 179
C51 COMPILER V9.00   I2C                                                                   05/22/2015 09:20:44 PAGE 18  

0330 E4                CLR     A
0331 900000      R     MOV     DPTR,#pt_i2c_read_complete
0334 F0                MOVX    @DPTR,A
0335 A3                INC     DPTR
0336 F0                MOVX    @DPTR,A
0337 900000      R     MOV     DPTR,#pt
033A E0                MOVX    A,@DPTR
033B FB                MOV     R3,A
033C A3                INC     DPTR
033D E0                MOVX    A,@DPTR
033E FA                MOV     R2,A
033F A3                INC     DPTR
0340 E0                MOVX    A,@DPTR
0341 F9                MOV     R1,A
0342 E4                CLR     A
0343 75F0B3            MOV     B,#0B3H
0346 120000      E     LCALL   ?C?ISTPTR
0349         ?C0110:
0349 7B01              MOV     R3,#01H
034B 7A00        R     MOV     R2,#HIGH pt_i2c_read_complete
034D 7900        R     MOV     R1,#LOW pt_i2c_read_complete
034F 120000      R     LCALL   _I2C_Read_Complete
0352 C3                CLR     C
0353 EF                MOV     A,R7
0354 6480              XRL     A,#080H
0356 9482              SUBB    A,#082H
0358 5002              JNC     ?C0112
035A 8001              SJMP    ?C0113
035C         ?C0112:
035C C3                CLR     C
035D         ?C0113:
035D 5003              JNC     ?C0105
035F 7F00              MOV     R7,#00H
0361 22                RET     
0362         ?C0105:
                                           ; SOURCE LINE # 182
0362 900000      E     MOV     DPTR,#wdt_count+011H
0365 E0                MOVX    A,@DPTR
0366 04                INC     A
0367 F0                MOVX    @DPTR,A
0368 7006              JNZ     ?C0174
036A 900000      E     MOV     DPTR,#wdt_count+010H
036D E0                MOVX    A,@DPTR
036E 04                INC     A
036F F0                MOVX    @DPTR,A
0370         ?C0174:
                                           ; SOURCE LINE # 183
0370 020000      R     LJMP    ?C0009
                                           ; SOURCE LINE # 184
0373         ?C0003:
0373 E4                CLR     A
0374 900000      R     MOV     DPTR,#PT_YIELD_FLAG
0377 F0                MOVX    @DPTR,A
0378 900000      R     MOV     DPTR,#pt
037B E0                MOVX    A,@DPTR
037C FB                MOV     R3,A
037D A3                INC     DPTR
037E E0                MOVX    A,@DPTR
037F FA                MOV     R2,A
0380 A3                INC     DPTR
0381 E0                MOVX    A,@DPTR
0382 F9                MOV     R1,A
C51 COMPILER V9.00   I2C                                                                   05/22/2015 09:20:44 PAGE 19  

0383 E4                CLR     A
0384 F5F0              MOV     B,A
0386 120000      E     LCALL   ?C?ISTPTR
0389 7F03              MOV     R7,#03H
                                           ; SOURCE LINE # 186
038B         ?C0012:
038B 22                RET     
             ; FUNCTION _I2C_Process (END)

             ; FUNCTION _I2C_Read_Buf (BEGIN)
                                           ; SOURCE LINE # 189
0000 900000      R     MOV     DPTR,#pt
0003 EB                MOV     A,R3
0004 F0                MOVX    @DPTR,A
0005 A3                INC     DPTR
0006 EA                MOV     A,R2
0007 F0                MOVX    @DPTR,A
0008 A3                INC     DPTR
0009 E9                MOV     A,R1
000A F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 190
                                           ; SOURCE LINE # 191
                                           ; SOURCE LINE # 193
000B 900000      R     MOV     DPTR,#PT_YIELD_FLAG
000E 7401              MOV     A,#01H
0010 F0                MOVX    @DPTR,A
0011 120000      E     LCALL   ?C?ILDPTR
0014 FF                MOV     R7,A
0015 AEF0              MOV     R6,B
0017 E5F0              MOV     A,B
0019 6003              JZ      $ + 5H
001B 020000      R     LJMP    ?C0114
001E EF                MOV     A,R7
001F 2436              ADD     A,#036H
0021 6042              JZ      ?C0121
0023 24E4              ADD     A,#0E4H
0025 7003              JNZ     $ + 5H
0027 020000      R     LJMP    ?C0132
002A 24E6              ADD     A,#0E6H
002C 6003              JZ      $ + 5H
002E 020000      R     LJMP    ?C0114
0031         ?C0115:
                                           ; SOURCE LINE # 195
0031 E4                CLR     A
0032 900000      R     MOV     DPTR,#read_byte_counter
0035 F0                MOVX    @DPTR,A
0036         ?C0116:
                                           ; SOURCE LINE # 197
0036 900000      R     MOV     DPTR,#len
0039 E0                MOVX    A,@DPTR
003A FF                MOV     R7,A
003B 900000      R     MOV     DPTR,#read_byte_counter
003E E0                MOVX    A,@DPTR
003F C3                CLR     C
0040 9F                SUBB    A,R7
0041 4003              JC      $ + 5H
0043 020000      R     LJMP    ?C0117
                                           ; SOURCE LINE # 198
                                           ; SOURCE LINE # 199
0046 E4                CLR     A
0047 900000      R     MOV     DPTR,#recieve_byte
004A F0                MOVX    @DPTR,A
C51 COMPILER V9.00   I2C                                                                   05/22/2015 09:20:44 PAGE 20  

                                           ; SOURCE LINE # 200
004B C2EE              CLR     MDE
                                           ; SOURCE LINE # 201
004D C2ED              CLR     MCO
                                           ; SOURCE LINE # 202
004F 900000      R     MOV     DPTR,#PT_YIELD_FLAG
0052 F0                MOVX    @DPTR,A
0053 900000      R     MOV     DPTR,#pt
0056 E0                MOVX    A,@DPTR
0057 FB                MOV     R3,A
0058 A3                INC     DPTR
0059 E0                MOVX    A,@DPTR
005A FA                MOV     R2,A
005B A3                INC     DPTR
005C E0                MOVX    A,@DPTR
005D F9                MOV     R1,A
005E E4                CLR     A
005F 75F0CA            MOV     B,#0CAH
0062 120000      E     LCALL   ?C?ISTPTR
0065         ?C0121:
0065 900000      R     MOV     DPTR,#PT_YIELD_FLAG
0068 E0                MOVX    A,@DPTR
0069 7003              JNZ     ?C0119
006B 7F01              MOV     R7,#01H
006D 22                RET     
006E         ?C0119:
                                           ; SOURCE LINE # 203
006E E4                CLR     A
006F 900000      R     MOV     DPTR,#bit_counter
0072 F0                MOVX    @DPTR,A
0073         ?C0124:
                                           ; SOURCE LINE # 204
                                           ; SOURCE LINE # 205
0073 D2ED              SETB    MCO
                                           ; SOURCE LINE # 208
0075 900000      R     MOV     DPTR,#recieve_byte
0078 E0                MOVX    A,@DPTR
0079 FF                MOV     R7,A
007A 25E0              ADD     A,ACC
007C FF                MOV     R7,A
007D A2EC              MOV     C,MDI
007F E4                CLR     A
0080 33                RLC     A
0081 4F                ORL     A,R7
0082 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 209
0083 C2ED              CLR     MCO
                                           ; SOURCE LINE # 210
0085 900000      R     MOV     DPTR,#bit_counter
0088 E0                MOVX    A,@DPTR
0089 04                INC     A
008A F0                MOVX    @DPTR,A
008B E0                MOVX    A,@DPTR
008C B408E4            CJNE    A,#08H,?C0124
008F         ?C0125:
                                           ; SOURCE LINE # 212
008F 900000      R     MOV     DPTR,#recieve_byte
0092 E0                MOVX    A,@DPTR
0093 FF                MOV     R7,A
0094 900000      R     MOV     DPTR,#buf
0097 E0                MOVX    A,@DPTR
0098 FB                MOV     R3,A
C51 COMPILER V9.00   I2C                                                                   05/22/2015 09:20:44 PAGE 21  

0099 A3                INC     DPTR
009A E0                MOVX    A,@DPTR
009B FA                MOV     R2,A
009C A3                INC     DPTR
009D E0                MOVX    A,@DPTR
009E F9                MOV     R1,A
009F 900000      R     MOV     DPTR,#read_byte_counter
00A2 E0                MOVX    A,@DPTR
00A3 F582              MOV     DPL,A
00A5 758300            MOV     DPH,#00H
00A8 EF                MOV     A,R7
00A9 120000      E     LCALL   ?C?CSTOPTR
                                           ; SOURCE LINE # 213
00AC 900000      R     MOV     DPTR,#read_byte_counter
00AF E0                MOVX    A,@DPTR
00B0 04                INC     A
00B1 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 216
00B2 D2EE              SETB    MDE
                                           ; SOURCE LINE # 217
00B4 900000      R     MOV     DPTR,#len
00B7 E0                MOVX    A,@DPTR
00B8 FF                MOV     R7,A
00B9 900000      R     MOV     DPTR,#read_byte_counter
00BC E0                MOVX    A,@DPTR
00BD C3                CLR     C
00BE 9F                SUBB    A,R7
00BF 5004              JNC     ?C0127
                                           ; SOURCE LINE # 218
                                           ; SOURCE LINE # 220
00C1 C2EF              CLR     MDO
                                           ; SOURCE LINE # 222
00C3 8002              SJMP    ?C0128
00C5         ?C0127:
                                           ; SOURCE LINE # 224
                                           ; SOURCE LINE # 226
00C5 D2EF              SETB    MDO
                                           ; SOURCE LINE # 227
00C7         ?C0128:
                                           ; SOURCE LINE # 229
00C7 D2ED              SETB    MCO
                                           ; SOURCE LINE # 230
00C9 E4                CLR     A
00CA 900000      R     MOV     DPTR,#PT_YIELD_FLAG
00CD F0                MOVX    @DPTR,A
00CE 900000      R     MOV     DPTR,#pt
00D1 E0                MOVX    A,@DPTR
00D2 FB                MOV     R3,A
00D3 A3                INC     DPTR
00D4 E0                MOVX    A,@DPTR
00D5 FA                MOV     R2,A
00D6 A3                INC     DPTR
00D7 E0                MOVX    A,@DPTR
00D8 F9                MOV     R1,A
00D9 E4                CLR     A
00DA 75F0E6            MOV     B,#0E6H
00DD 120000      E     LCALL   ?C?ISTPTR
00E0         ?C0132:
00E0 900000      R     MOV     DPTR,#PT_YIELD_FLAG
00E3 E0                MOVX    A,@DPTR
00E4 7003              JNZ     ?C0130
00E6 7F01              MOV     R7,#01H
C51 COMPILER V9.00   I2C                                                                   05/22/2015 09:20:44 PAGE 22  

00E8 22                RET     
00E9         ?C0130:
                                           ; SOURCE LINE # 231
00E9 C2ED              CLR     MCO
                                           ; SOURCE LINE # 233
00EB C2EE              CLR     MDE
                                           ; SOURCE LINE # 235
00ED 020000      R     LJMP    ?C0116
00F0         ?C0117:
                                           ; SOURCE LINE # 236
00F0 D2EE              SETB    MDE
                                           ; SOURCE LINE # 237
00F2 E4                CLR     A
00F3 900000      R     MOV     DPTR,#ERROR_I2C
00F6 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 238
00F7         ?C0114:
00F7 E4                CLR     A
00F8 900000      R     MOV     DPTR,#PT_YIELD_FLAG
00FB F0                MOVX    @DPTR,A
00FC 900000      R     MOV     DPTR,#pt
00FF E0                MOVX    A,@DPTR
0100 FB                MOV     R3,A
0101 A3                INC     DPTR
0102 E0                MOVX    A,@DPTR
0103 FA                MOV     R2,A
0104 A3                INC     DPTR
0105 E0                MOVX    A,@DPTR
0106 F9                MOV     R1,A
0107 E4                CLR     A
0108 F5F0              MOV     B,A
010A 120000      E     LCALL   ?C?ISTPTR
010D 7F03              MOV     R7,#03H
                                           ; SOURCE LINE # 239
010F         ?C0123:
010F 22                RET     
             ; FUNCTION _I2C_Read_Buf (END)

             ; FUNCTION _I2C_Write_Buf (BEGIN)
                                           ; SOURCE LINE # 242
0000 900000      R     MOV     DPTR,#pt
0003 EB                MOV     A,R3
0004 F0                MOVX    @DPTR,A
0005 A3                INC     DPTR
0006 EA                MOV     A,R2
0007 F0                MOVX    @DPTR,A
0008 A3                INC     DPTR
0009 E9                MOV     A,R1
000A F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 243
                                           ; SOURCE LINE # 244
                                           ; SOURCE LINE # 245
000B 900000      R     MOV     DPTR,#PT_YIELD_FLAG
000E 7401              MOV     A,#01H
0010 F0                MOVX    @DPTR,A
0011 120000      E     LCALL   ?C?ILDPTR
0014 120000      E     LCALL   ?C?ICASE
0017 0000        R     DW      ?C0135
0019 0000              DW      00H
001B 0000        R     DW      ?C0141
001D 00FF              DW      0FFH
001F 0000        R     DW      ?C0150
C51 COMPILER V9.00   I2C                                                                   05/22/2015 09:20:44 PAGE 23  

0021 0107              DW      0107H
0023 0000        R     DW      ?C0155
0025 010E              DW      010EH
0027 0000        R     DW      ?C0160
0029 0110              DW      0110H
002B 0000              DW      00H
002D 0000        R     DW      ?C0134
002F         ?C0135:
                                           ; SOURCE LINE # 246
002F D2EE              SETB    MDE
                                           ; SOURCE LINE # 247
0031 E4                CLR     A
0032 900000      R     MOV     DPTR,#write_byte_counter
0035 F0                MOVX    @DPTR,A
0036         ?C0136:
                                           ; SOURCE LINE # 248
0036 900000      R     MOV     DPTR,#len
0039 E0                MOVX    A,@DPTR
003A FF                MOV     R7,A
003B 900000      R     MOV     DPTR,#write_byte_counter
003E E0                MOVX    A,@DPTR
003F C3                CLR     C
0040 9F                SUBB    A,R7
0041 4003              JC      $ + 5H
0043 020000      R     LJMP    ?C0137
                                           ; SOURCE LINE # 249
                                           ; SOURCE LINE # 252
0046 900000      R     MOV     DPTR,#buf
0049 E0                MOVX    A,@DPTR
004A FB                MOV     R3,A
004B A3                INC     DPTR
004C E0                MOVX    A,@DPTR
004D FA                MOV     R2,A
004E A3                INC     DPTR
004F E0                MOVX    A,@DPTR
0050 F9                MOV     R1,A
0051 900000      R     MOV     DPTR,#write_byte_counter
0054 E0                MOVX    A,@DPTR
0055 F582              MOV     DPL,A
0057 758300            MOV     DPH,#00H
005A 120000      E     LCALL   ?C?CLDOPTR
005D 900000      R     MOV     DPTR,#write_byte
0060 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 253
0061 900000      R     MOV     DPTR,#write_byte_counter
0064 E0                MOVX    A,@DPTR
0065 04                INC     A
0066 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 254
0067 C2ED              CLR     MCO
                                           ; SOURCE LINE # 255
0069 E4                CLR     A
006A 900000      R     MOV     DPTR,#PT_YIELD_FLAG
006D F0                MOVX    @DPTR,A
006E 900000      R     MOV     DPTR,#pt
0071 E0                MOVX    A,@DPTR
0072 FB                MOV     R3,A
0073 A3                INC     DPTR
0074 E0                MOVX    A,@DPTR
0075 FA                MOV     R2,A
0076 A3                INC     DPTR
0077 E0                MOVX    A,@DPTR
C51 COMPILER V9.00   I2C                                                                   05/22/2015 09:20:44 PAGE 24  

0078 F9                MOV     R1,A
0079 E4                CLR     A
007A 75F0FF            MOV     B,#0FFH
007D 120000      E     LCALL   ?C?ISTPTR
0080         ?C0141:
0080 900000      R     MOV     DPTR,#PT_YIELD_FLAG
0083 E0                MOVX    A,@DPTR
0084 7003              JNZ     ?C0139
0086 7F01              MOV     R7,#01H
0088 22                RET     
0089         ?C0139:
                                           ; SOURCE LINE # 256
0089 E4                CLR     A
008A 900000      R     MOV     DPTR,#bit_counter
008D F0                MOVX    @DPTR,A
008E         ?C0144:
                                           ; SOURCE LINE # 257
                                           ; SOURCE LINE # 259
008E 900000      R     MOV     DPTR,#write_byte
0091 E0                MOVX    A,@DPTR
0092 FF                MOV     R7,A
0093 25E0              ADD     A,ACC
0095 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 260
0096 92EF              MOV     MDO,C
                                           ; SOURCE LINE # 262
0098 D2ED              SETB    MCO
                                           ; SOURCE LINE # 263
009A E4                CLR     A
009B 900000      R     MOV     DPTR,#PT_YIELD_FLAG
009E F0                MOVX    @DPTR,A
009F 900000      R     MOV     DPTR,#pt
00A2 E0                MOVX    A,@DPTR
00A3 FB                MOV     R3,A
00A4 A3                INC     DPTR
00A5 E0                MOVX    A,@DPTR
00A6 FA                MOV     R2,A
00A7 A3                INC     DPTR
00A8 E0                MOVX    A,@DPTR
00A9 F9                MOV     R1,A
00AA 7401              MOV     A,#01H
00AC 75F007            MOV     B,#07H
00AF 120000      E     LCALL   ?C?ISTPTR
00B2         ?C0150:
00B2 900000      R     MOV     DPTR,#PT_YIELD_FLAG
00B5 E0                MOVX    A,@DPTR
00B6 7003              JNZ     ?C0148
00B8 7F01              MOV     R7,#01H
00BA 22                RET     
00BB         ?C0148:
                                           ; SOURCE LINE # 264
00BB C2ED              CLR     MCO
                                           ; SOURCE LINE # 267
00BD 900000      R     MOV     DPTR,#bit_counter
00C0 E0                MOVX    A,@DPTR
00C1 04                INC     A
00C2 F0                MOVX    @DPTR,A
00C3 E0                MOVX    A,@DPTR
00C4 B408C7            CJNE    A,#08H,?C0144
00C7         ?C0145:
                                           ; SOURCE LINE # 268
00C7 C2EE              CLR     MDE
C51 COMPILER V9.00   I2C                                                                   05/22/2015 09:20:44 PAGE 25  

                                           ; SOURCE LINE # 269
00C9 C2ED              CLR     MCO
                                           ; SOURCE LINE # 270
00CB E4                CLR     A
00CC 900000      R     MOV     DPTR,#PT_YIELD_FLAG
00CF F0                MOVX    @DPTR,A
00D0 900000      R     MOV     DPTR,#pt
00D3 E0                MOVX    A,@DPTR
00D4 FB                MOV     R3,A
00D5 A3                INC     DPTR
00D6 E0                MOVX    A,@DPTR
00D7 FA                MOV     R2,A
00D8 A3                INC     DPTR
00D9 E0                MOVX    A,@DPTR
00DA F9                MOV     R1,A
00DB 7401              MOV     A,#01H
00DD 75F00E            MOV     B,#0EH
00E0 120000      E     LCALL   ?C?ISTPTR
00E3         ?C0155:
00E3 900000      R     MOV     DPTR,#PT_YIELD_FLAG
00E6 E0                MOVX    A,@DPTR
00E7 7003              JNZ     ?C0153
00E9 7F01              MOV     R7,#01H
00EB 22                RET     
00EC         ?C0153:
                                           ; SOURCE LINE # 271
00EC D2ED              SETB    MCO
                                           ; SOURCE LINE # 272
00EE E4                CLR     A
00EF 900000      R     MOV     DPTR,#PT_YIELD_FLAG
00F2 F0                MOVX    @DPTR,A
00F3 900000      R     MOV     DPTR,#pt
00F6 E0                MOVX    A,@DPTR
00F7 FB                MOV     R3,A
00F8 A3                INC     DPTR
00F9 E0                MOVX    A,@DPTR
00FA FA                MOV     R2,A
00FB A3                INC     DPTR
00FC E0                MOVX    A,@DPTR
00FD F9                MOV     R1,A
00FE 7401              MOV     A,#01H
0100 75F010            MOV     B,#010H
0103 120000      E     LCALL   ?C?ISTPTR
0106         ?C0160:
0106 900000      R     MOV     DPTR,#PT_YIELD_FLAG
0109 E0                MOVX    A,@DPTR
010A 7003              JNZ     ?C0158
010C 7F01              MOV     R7,#01H
010E 22                RET     
010F         ?C0158:
                                           ; SOURCE LINE # 273
010F C2ED              CLR     MCO
                                           ; SOURCE LINE # 274
0111 D2EE              SETB    MDE
                                           ; SOURCE LINE # 275
0113 20EC03            JB      MDI,$ + 6H
0116 020000      R     LJMP    ?C0136
                                           ; SOURCE LINE # 276
                                           ; SOURCE LINE # 277
0119 900000      R     MOV     DPTR,#ERROR_I2C
011C 7401              MOV     A,#01H
011E F0                MOVX    @DPTR,A
C51 COMPILER V9.00   I2C                                                                   05/22/2015 09:20:44 PAGE 26  

                                           ; SOURCE LINE # 278
011F 900000      R     MOV     DPTR,#pt
0122 E0                MOVX    A,@DPTR
0123 FB                MOV     R3,A
0124 A3                INC     DPTR
0125 E0                MOVX    A,@DPTR
0126 FA                MOV     R2,A
0127 A3                INC     DPTR
0128 E0                MOVX    A,@DPTR
0129 F9                MOV     R1,A
012A E4                CLR     A
012B F5F0              MOV     B,A
012D 120000      E     LCALL   ?C?ISTPTR
0130 7F02              MOV     R7,#02H
0132 22                RET     
                                           ; SOURCE LINE # 279
                                           ; SOURCE LINE # 280
0133         ?C0137:
                                           ; SOURCE LINE # 281
0133 E4                CLR     A
0134 900000      R     MOV     DPTR,#ERROR_I2C
0137 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 282
0138         ?C0134:
0138 E4                CLR     A
0139 900000      R     MOV     DPTR,#PT_YIELD_FLAG
013C F0                MOVX    @DPTR,A
013D 900000      R     MOV     DPTR,#pt
0140 E0                MOVX    A,@DPTR
0141 FB                MOV     R3,A
0142 A3                INC     DPTR
0143 E0                MOVX    A,@DPTR
0144 FA                MOV     R2,A
0145 A3                INC     DPTR
0146 E0                MOVX    A,@DPTR
0147 F9                MOV     R1,A
0148 E4                CLR     A
0149 F5F0              MOV     B,A
014B 120000      E     LCALL   ?C?ISTPTR
014E 7F03              MOV     R7,#03H
                                           ; SOURCE LINE # 283
0150         ?C0143:
0150 22                RET     
             ; FUNCTION _I2C_Write_Buf (END)

             ; FUNCTION _I2C_Read_Complete (BEGIN)
                                           ; SOURCE LINE # 285
0000 900000      R     MOV     DPTR,#pt
0003 EB                MOV     A,R3
0004 F0                MOVX    @DPTR,A
0005 A3                INC     DPTR
0006 EA                MOV     A,R2
0007 F0                MOVX    @DPTR,A
0008 A3                INC     DPTR
0009 E9                MOV     A,R1
000A F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 286
                                           ; SOURCE LINE # 287
000B A3                INC     DPTR
000C 7401              MOV     A,#01H
000E F0                MOVX    @DPTR,A
000F 120000      E     LCALL   ?C?ILDPTR
C51 COMPILER V9.00   I2C                                                                   05/22/2015 09:20:44 PAGE 27  

0012 FF                MOV     R7,A
0013 AEF0              MOV     R6,B
0015 707C              JNZ     ?C0166
0017 EE                MOV     A,R6
0018 7079              JNZ     ?C0166
001A         ?C0167:
                                           ; SOURCE LINE # 288
001A 7E00        R     MOV     R6,#HIGH i2c_channels
001C 7F00        R     MOV     R7,#LOW i2c_channels
001E 7D0A              MOV     R5,#0AH
0020 120000      E     LCALL   _CRC_Check
0023 900000      R     MOV     DPTR,#i2c_channels+0AH
0026 E0                MOVX    A,@DPTR
0027 6F                XRL     A,R7
0028 7065              JNZ     ?C0168
                                           ; SOURCE LINE # 289
                                           ; SOURCE LINE # 293
002A 900000      R     MOV     DPTR,#i2c_channels+04H
002D E0                MOVX    A,@DPTR
002E 6022              JZ      ?C0171
0030 14                DEC     A
0031 704C              JNZ     ?C0169
                                           ; SOURCE LINE # 294
                                           ; SOURCE LINE # 295
0033         ?C0170:
                                           ; SOURCE LINE # 296
                                           ; SOURCE LINE # 297
0033 900000      R     MOV     DPTR,#i2c_channels+05H
0036 E0                MOVX    A,@DPTR
0037 FE                MOV     R6,A
0038 A3                INC     DPTR
0039 E0                MOVX    A,@DPTR
003A FF                MOV     R7,A
003B E4                CLR     A
003C FC                MOV     R4,A
003D FD                MOV     R5,A
003E 900000      E     MOV     DPTR,#channels+069H
0041 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 298
0044 900000      E     MOV     DPTR,#channels+066H
0047 7401              MOV     A,#01H
0049 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 299
004A 900000      E     MOV     DPTR,#channel_number
004D 7405              MOV     A,#05H
004F F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 301
                                           ; SOURCE LINE # 302
0050 802D              SJMP    ?C0169
                                           ; SOURCE LINE # 304
0052         ?C0171:
                                           ; SOURCE LINE # 305
                                           ; SOURCE LINE # 306
0052 900000      R     MOV     DPTR,#i2c_channels+05H
0055 E0                MOVX    A,@DPTR
0056 FE                MOV     R6,A
0057 A3                INC     DPTR
0058 E0                MOVX    A,@DPTR
0059 FF                MOV     R7,A
005A E4                CLR     A
005B FC                MOV     R4,A
005C FD                MOV     R5,A
C51 COMPILER V9.00   I2C                                                                   05/22/2015 09:20:44 PAGE 28  

005D 900000      E     MOV     DPTR,#channels+069H
0060 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 307
0063 900000      R     MOV     DPTR,#i2c_channels+07H
0066 E0                MOVX    A,@DPTR
0067 FE                MOV     R6,A
0068 A3                INC     DPTR
0069 E0                MOVX    A,@DPTR
006A FF                MOV     R7,A
006B E4                CLR     A
006C FC                MOV     R4,A
006D FD                MOV     R5,A
006E 900000      E     MOV     DPTR,#channels+082H
0071 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 308
0074 E4                CLR     A
0075 900000      E     MOV     DPTR,#channels+066H
0078 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 309
0079 900000      E     MOV     DPTR,#channel_number
007C 7406              MOV     A,#06H
007E F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 310
                                           ; SOURCE LINE # 311
                                           ; SOURCE LINE # 313
                                           ; SOURCE LINE # 314
                                           ; SOURCE LINE # 315
                                           ; SOURCE LINE # 316
                                           ; SOURCE LINE # 317
007F         ?C0169:
                                           ; SOURCE LINE # 319
007F 900000      E     MOV     DPTR,#STATE_BYTE
0082 E0                MOVX    A,@DPTR
0083 FF                MOV     R7,A
0084 900000      R     MOV     DPTR,#i2c_channels+09H
0087 E0                MOVX    A,@DPTR
0088 FE                MOV     R6,A
0089 EF                MOV     A,R7
008A 4E                ORL     A,R6
008B 900000      E     MOV     DPTR,#STATE_BYTE
008E F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 320
008F         ?C0168:
                                           ; SOURCE LINE # 321
008F E4                CLR     A
0090 7800        R     MOV     R0,#LOW i2c_buffer
0092 F6                MOV     @R0,A
                                           ; SOURCE LINE # 323
0093         ?C0166:
0093 E4                CLR     A
0094 900000      R     MOV     DPTR,#PT_YIELD_FLAG
0097 F0                MOVX    @DPTR,A
0098 900000      R     MOV     DPTR,#pt
009B E0                MOVX    A,@DPTR
009C FB                MOV     R3,A
009D A3                INC     DPTR
009E E0                MOVX    A,@DPTR
009F FA                MOV     R2,A
00A0 A3                INC     DPTR
00A1 E0                MOVX    A,@DPTR
00A2 F9                MOV     R1,A
00A3 E4                CLR     A
C51 COMPILER V9.00   I2C                                                                   05/22/2015 09:20:44 PAGE 29  

00A4 F5F0              MOV     B,A
00A6 120000      E     LCALL   ?C?ISTPTR
00A9 7F03              MOV     R7,#03H
                                           ; SOURCE LINE # 324
00AB         ?C0173:
00AB 22                RET     
             ; FUNCTION _I2C_Read_Complete (END)

C51 COMPILER V9.00   I2C                                                                   05/22/2015 09:20:44 PAGE 30  

NAME                                    CLASS   MSPACE  TYPE    OFFSET  SIZE
====                                    =====   ======  ====    ======  ====


TCON . . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   0088H  1
SCON . . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   0098H  1
P2 . . . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00A0H  1
IE . . . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00A8H  1
P3 . . . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00B0H  1
IP . . . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00B8H  1
WDCON. . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00C0H  1
T2CON. . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00C8H  1
PSW. . . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00D0H  1
ADCSTAT. . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00D8H  1
I2CCON . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00E8H  1
DCON . . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00E8H  1
SPICON . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00F8H  1
CY . . . . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      00D7H  1
MDO. . . . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      00EFH  1
MDE. . . . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      00EEH  1
MCO. . . . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      00EDH  1
MDI. . . . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      00ECH  1
I2CM . . . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      00EBH  1
lc_t . . . . . . . . . . . . . . . . .  TYPEDEF  -----  U_INT    -----  2
pt . . . . . . . . . . . . . . . . . .  * TAG *  -----  STRUCT   -----  4
  lc . . . . . . . . . . . . . . . . .  MEMBER   -----  U_INT    0000H  2
  pt_time. . . . . . . . . . . . . . .  MEMBER   -----  U_INT    0002H  2
size_t . . . . . . . . . . . . . . . .  TYPEDEF  -----  U_INT    -----  2
CHNL_ADC_0 . . . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
CHNL_ADC_1 . . . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
CHNL_ADC_2 . . . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
CHNL_ADC_3 . . . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
CHNL_FREQ_COUNT_T_0. . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
CHNL_FREQ_COUNT_T_1. . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
Channel. . . . . . . . . . . . . . . .  * TAG *  -----  STRUCT   -----  25
  number . . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0000H  1
  settings . . . . . . . . . . . . . .  MEMBER   -----  UNION    0001H  4
  channel_data . . . . . . . . . . . .  MEMBER   -----  U_LONG   0005H  4
  channel_data_calibrate . . . . . . .  MEMBER   -----  U_LONG   0009H  4
  calibrate. . . . . . . . . . . . . .  MEMBER   -----  UNION    000DH  12
I2C_Channel. . . . . . . . . . . . . .  * TAG *  -----  STRUCT   -----  11
  I2C_CHNL . . . . . . . . . . . . . .  MEMBER   -----  UNION    0000H  11
I2C_Init . . . . . . . . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
_I2C_Process . . . . . . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  pt . . . . . . . . . . . . . . . . .  AUTO     XDATA  PTR      0000H  3
  PT_YIELD_FLAG. . . . . . . . . . . .  AUTO     XDATA  CHAR     0003H  1
_I2C_Repeat_Start_Read . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  addr . . . . . . . . . . . . . . . .  AUTO     DATA   U_CHAR   0007H  1
  par_buf. . . . . . . . . . . . . . .  AUTO     DATA   PTR      0001H  3
  par_buf_len. . . . . . . . . . . . .  AUTO     XDATA  U_CHAR   0004H  1
  buf. . . . . . . . . . . . . . . . .  AUTO     XDATA  PTR      0005H  3
  buf_len. . . . . . . . . . . . . . .  AUTO     XDATA  U_CHAR   0008H  1
channels . . . . . . . . . . . . . . .  EXTERN   XDATA  ARRAY    -----  150
_CRC_Check . . . . . . . . . . . . . .  EXTERN   CODE   PROC     -----  -----
Proto_Proc . . . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
Sort_Proc. . . . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
Watch_Proc . . . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
I2C_RepeatRead_Proc. . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
Frequency_Measure_Proc . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
I2C_Proc . . . . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
RUN. . . . . . . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
C51 COMPILER V9.00   I2C                                                                   05/22/2015 09:20:44 PAGE 31  

NAME                                    CLASS   MSPACE  TYPE    OFFSET  SIZE
====                                    =====   ======  ====    ======  ====


IDLE . . . . . . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
watchdog . . . . . . . . . . . . . . .  * TAG *  -----  STRUCT   -----  3
  process_state. . . . . . . . . . . .  MEMBER   -----  U_CHAR   0000H  1
  count. . . . . . . . . . . . . . . .  MEMBER   -----  U_INT    0001H  2
wdt_count. . . . . . . . . . . . . . .  EXTERN   XDATA  ARRAY    -----  -----
DEV_ADDR . . . . . . . . . . . . . . .  PUBLIC   XDATA  U_CHAR   0006H  1
byte_num_write . . . . . . . . . . . .  PUBLIC   XDATA  U_CHAR   0007H  1
byte_num_read. . . . . . . . . . . . .  PUBLIC   XDATA  U_CHAR   0008H  1
i2c_buf. . . . . . . . . . . . . . . .  PUBLIC   XDATA  PTR      0009H  3
temp_val . . . . . . . . . . . . . . .  PUBLIC   XDATA  U_CHAR   000CH  1
i2c_mas. . . . . . . . . . . . . . . .  PUBLIC   XDATA  ARRAY    000DH  10
i2c_channels . . . . . . . . . . . . .  PUBLIC   XDATA  STRUCT   0017H  11
i2c_buffer . . . . . . . . . . . . . .  PUBLIC   IDATA  ARRAY    0000H  6
STATE_BYTE . . . . . . . . . . . . . .  EXTERN   XDATA  U_CHAR   -----  1
channel_number . . . . . . . . . . . .  EXTERN   XDATA  U_CHAR   -----  1
START_I2C. . . . . . . . . . . . . . .  PUBLIC   XDATA  U_CHAR   0022H  1
ERROR_I2C. . . . . . . . . . . . . . .  PUBLIC   XDATA  U_CHAR   0023H  1
pt_i2c_read_buf. . . . . . . . . . . .  PUBLIC   XDATA  STRUCT   0024H  4
pt_i2c_write_buf . . . . . . . . . . .  PUBLIC   XDATA  STRUCT   0028H  4
pt_i2c_read_complete . . . . . . . . .  PUBLIC   XDATA  STRUCT   002CH  4
_I2C_Read_Buf. . . . . . . . . . . . .  STATIC   CODE   PROC     0000H  -----
  pt . . . . . . . . . . . . . . . . .  AUTO     XDATA  PTR      0000H  3
  buf. . . . . . . . . . . . . . . . .  AUTO     XDATA  PTR      0003H  3
  len. . . . . . . . . . . . . . . . .  AUTO     XDATA  U_CHAR   0006H  1
  PT_YIELD_FLAG. . . . . . . . . . . .  AUTO     XDATA  CHAR     0007H  1
  read_byte_counter. . . . . . . . . .  STATIC   XDATA  U_CHAR   0000H  1
  bit_counter. . . . . . . . . . . . .  STATIC   XDATA  U_CHAR   0001H  1
  recieve_byte . . . . . . . . . . . .  STATIC   XDATA  U_CHAR   0002H  1
_I2C_Write_Buf . . . . . . . . . . . .  STATIC   CODE   PROC     0000H  -----
  pt . . . . . . . . . . . . . . . . .  AUTO     XDATA  PTR      0000H  3
  buf. . . . . . . . . . . . . . . . .  AUTO     XDATA  PTR      0003H  3
  len. . . . . . . . . . . . . . . . .  AUTO     XDATA  U_CHAR   0006H  1
  PT_YIELD_FLAG. . . . . . . . . . . .  AUTO     XDATA  CHAR     0007H  1
  write_byte_counter . . . . . . . . .  STATIC   XDATA  U_CHAR   0003H  1
  bit_counter. . . . . . . . . . . . .  STATIC   XDATA  U_CHAR   0004H  1
  write_byte . . . . . . . . . . . . .  STATIC   XDATA  U_CHAR   0005H  1
_I2C_Read_Complete . . . . . . . . . .  STATIC   CODE   PROC     0000H  -----
  pt . . . . . . . . . . . . . . . . .  AUTO     XDATA  PTR      0000H  3
  PT_YIELD_FLAG. . . . . . . . . . . .  AUTO     XDATA  CHAR     0003H  1


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =   1752    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =     48      33
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =      6    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  2 WARNING(S),  0 ERROR(S)
